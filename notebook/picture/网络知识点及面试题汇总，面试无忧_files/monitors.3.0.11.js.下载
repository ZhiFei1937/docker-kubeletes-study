!function(){"use strict";var s=function(){return(s=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++)for(var i in e=arguments[n])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t}).apply(this,arguments)};function v(t){var e="function"==typeof Symbol&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&"number"==typeof t.length)return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function n(t,e){var n="function"==typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||0<e--)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function c(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(n(arguments[e]));return t}function a(t){return"object"==typeof t&&null!==t&&!f(t)}function u(t){return"function"==typeof t}function l(t){return"[object String]"===Object.prototype.toString.call(t)}function f(t){return"[object Array]"===Object.prototype.toString.call(t)}function r(t){return"number"==typeof t}function o(t,e){var n,r,i,o;if(void 0===t.length)for(n in t)i=t,o=n,Object.prototype.hasOwnProperty.call(i,o)&&e.call(null,n,t[n]);else if(r=t.length)for(n=0;n<r;n++)e.call(null,n,t[n])}function i(t){var n,e=function(t){if(!a(t))return{};var n={};return o(t,function(t,e){a(e)||f(e)?n[t]=JSON.stringify(e):n[t]=e}),n}(t),r=(n={},o(e,function(t,e){n[encodeURIComponent(t)]=encodeURIComponent(e)}),n),i=[];return o(r,function(t,e){i.push(t+"="+e)}),i.join("&")}function m(t){var e=document.createElement("a");e.href=t;var n=e.pathname||"/";return"/"!==n[0]&&(n="/"+n),{href:e.href,protocol:e.protocol.slice(0,-1),hostname:e.hostname,host:e.host,pathname:n,hash:e.hash}}function e(){return!!a(window)}function d(){return!(!e()||!a(window.performance))}function p(){return!(!d()||!a(window.performance.timing))}function _(){return!(!d()||!u(window.performance.getEntries))}function h(){return!(!u(requestAnimationFrame)||!u(cancelAnimationFrame))}function t(){return!(!window.setTimeout||!u(setTimeout))}function g(){return e()&&"function"==typeof window.PerformanceObserver}function y(){return g()&&u(window.PerformanceLongTaskTiming)}function b(){return g()&&u(window.PerformanceResourceTiming)}function w(){if(g()){var t=window.PerformanceObserverEntryList;return u(t)&&u(t.prototype.getEntries)}}function T(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]}function k(t){"complete"!==document.readyState?window.addEventListener("load",function(){setTimeout(function(){t()},0)},!1):t()}function S(t){return f(t)&&t.length?function(t){for(var e=[],n=t.length,r=0;r<n;r++){var i=t[r];l(i)?e.push(i.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")):i&&i.source&&e.push(i.source)}return new RegExp(e.join("|"),"i")}(t):null}function L(){return(new Date).getTime()}function E(){var t=function(){for(var t=new Array(16),e=0,n=void 0;e<16;e++)0==(3&e)&&(n=4294967296*Math.random()),t[e]=n>>>((3&e)<<3)&255;return t}();return t[6]=15&t[6]|64,t[8]=63&t[8]|128,function(t){for(var e=[],n=0;n<256;++n)e[n]=(n+256).toString(16).substr(1);var r=0;return[e[t[r++]],e[t[r++]],e[t[r++]],e[t[r++]],"-",e[t[r++]],e[t[r++]],"-",e[t[r++]],e[t[r++]],"-",e[t[r++]],e[t[r++]],"-",e[t[r++]],e[t[r++]],e[t[r++]],e[t[r++]],e[t[r++]],e[t[r++]]].join("")}(t)}E(),E();var M=(P.prototype.postEvent=function(t){var e=s(s({},t),this._getCommonParams());P.post(this._url,e)},P.prototype.getEvent=function(t){var e=i(s(s({},t),this._getCommonParams())),n=this._url+"?"+e;P.get(n)},P.post=function(t,e,n){var r,i,o=null!==(r=null==n?void 0:n.success)&&void 0!==r?r:T,a=null!==(i=null==n?void 0:n.fail)&&void 0!==i?i:T,s=new XMLHttpRequest;s.open("POST",t,!0),s.setRequestHeader("Content-Type","application/json"),s.send(JSON.stringify(e)),s.onload=function(){try{if(this.responseText){var t=JSON.parse(this.responseText);o(t)}else o()}catch(t){a()}},s.onerror=function(){a()},s.onabort=function(){a()}},P.get=function(t,e){var n,r,i,o,a=null!==(n=null==e?void 0:e.success)&&void 0!==n?n:T,s=null!==(r=null==e?void 0:e.fail)&&void 0!==r?r:T,c=null!==(i=null==e?void 0:e.getResponse)&&void 0!==i?i:T,u=null!==(o=null==e?void 0:e.getResponseText)&&void 0!==o?o:T,l=new XMLHttpRequest;l.open("GET",t),l.send(),l.onload=function(){c(null==this?void 0:this.response),u(null==this?void 0:this.responseText);try{if(this.responseText){var t=JSON.parse(this.responseText);a(t)}else a()}catch(t){s()}},l.onerror=function(){s()},l.onabort=function(){s()}},P.prototype._getURL=function(){return"https://"+(this._options.reportDomain||"i.snssdk.com")+"/log/sentry/v2/api/slardar/main/"},P.prototype.getURL=function(){return this._url},P.prototype._getCommonParams=function(){return{timestamp:Date.now()}},P);function P(t){this._options=t||{},this._url=this._options.reportURL||this._getURL()}function I(){return Date.now()}var C=(R.prototype.begin=function(){this._currentTime=I(),this._beginTime=I(),this._frames=0},R.prototype.frame=function(){return this._currentTime=I(),this._currentTime-this._beginTime},R.prototype.end=function(){var t;return this._frames++,this._currentTime=I(),this._currentTime>=this._beginTime+this._duration&&(t=this._frames*this._duration/(this._currentTime-this._beginTime),this._beginTime=this._currentTime,this._frames=0),t},R);function R(t){this._beginTime=I(),this._frames=0,this._duration=t||1e3,this._currentTime=I()}var q,O,x=1e3;(O=q=q||{}).once="once",O.repeat="repeat",O.frame="frame";var F=function(t){var e=this;this.name="FPSMonitor",this._fpsInstance=null,this._animateId=0,this._fpsList=[],this._mode="once",this._onceTime=x,this.setup=function(t){h()&&(e._fpsInstance=new C(x),e._callback=t||T,e._fpsInstance.begin(),e._mode!==q.repeat?e._mode!==q.frame?e._mode===q.once&&e._animateOnce():e._animateId=requestAnimationFrame(e._animateFrame):e._animateRepeat())},this.getFps=function(){return e._fpsList},this._animateRepeat=function(){if(h()){var t=e._fpsInstance.end();void 0!==t&&(e._fpsList.push(t),e._sendFps(t)),e._animateId=requestAnimationFrame(e._animateRepeat)}},this._animateOnce=function(){if(h()){var t=e._fpsInstance.end();if(void 0!==t)return e._fpsList.push(t),e._sendFps(t),void(e._fpsList.length>=Math.floor(e._onceTime/x)&&cancelAnimationFrame(e._animateId));e._animateId=requestAnimationFrame(e._animateOnce)}},this._animateFrame=function(){if(h()){var t=e._fpsInstance.frame();void 0!==t&&(e._sendFrame(t),cancelAnimationFrame(e._animateId))}},this._sendFps=function(t){u(e._callback)&&e._callback({name:e.name,type:"post",event:{ev_type:"fps",fps:t}})},this._sendFrame=function(t){u(e._callback)&&e._callback({name:e.name,type:"post",event:{ev_type:"frame_duration",frame:t}})},t&&(this._mode=t.mode||q.once,this._onceTime=t.onceTime||x)};function j(t){try{for(var e=t,n=[],r=0,i=0,o=" > ".length,a=void 0;e&&r++<5&&!("html"===(a=A(e))||1<r&&80<=i+n.length*o+a.length);)n.push(a),i+=a.length,e=e.parentNode;return n.reverse().join(" > ")}catch(t){return"<unknown>"}}function A(t){var e,n,r,i,o,a=t,s=[];if(!a||!a.tagName)return"";if(s.push(a.tagName.toLowerCase()),a.id&&s.push("#"+a.id),(e=a.className)&&l(e))for(n=e.split(/\s+/),o=0;o<n.length;o++)s.push("."+n[o]);var c=["type","name","title","alt"];for(o=0;o<c.length;o++)r=c[o],(i=a.getAttribute(r))&&s.push("["+r+'="'+i+'"]');return s.join("")}function D(){return u(Date)?Math.round(Date.now()/1e3):0}function H(t,n){if(!a(t))return{};if(!u(n))return{};var r={};return o(t,function(t,e){n(e)&&(r[t]=e)}),r}var J=function(t){var e;return a(t)&&l(t.name)&&r(t.value)?{metrics_type:"counter",event_name:"default",metrics:((e={})[t.name]=t.value,e),category:H(t.tags,l),timestamp:D()}:{}},N=function(t){var e;return a(t)&&l(t.name)&&r(t.value)?{metrics_type:"timer",event_name:"default",metrics:((e={})[t.name]=t.value,e),category:H(t.tags,l),timestamp:D()}:{}},B=function(t){return a(t)&&l(t.value)?{metrics_type:"log",event_name:"default",log_content:t.value,log_level:t.level||"info",category:H(t.tags,l),timestamp:D()}:{}},U=function(t){return a(t)&&l(t.event_name)?{metrics_type:"custom",event_name:t.event_name,metrics:H(t.metrics,r),category:H(t.tags,l),timestamp:D()}:{}};function W(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e]}var Q=(X.prototype.onLeave=function(){var t;1<this._frameList.length&&(this.report(),null!==(t=this._slardarInstance)&&void 0!==t&&t.call(this,"report")),this._frameList=[],window.clearTimeout(this.timerId)},X.prototype.onShow=function(){this._frameList=[],this.start()},X.prototype.setup=function(n){void 0===n&&(n=T),t()&&(this._callback=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];n.apply(void 0,c(t))},this.start())},X.prototype.start=function(){this._fpsMonitor.setup(this._getFrameList)},X);function X(t){var e,n,m=this;this.name="FPSJankTimesMonitor",this._getFrameList=function(t){var e=t.event.frame,n=40<e,r=m._frameList.length,i={frame:e,isJank:n,timestamp:L()},o=m._frameList[r-1]||{},a=!i.isJank&&o.isJank,s=!i.isJank&&!o.isJank;i.isJank&&!o.isJank||a||i.isJank&&o.isJank?m._frameList.push(i):s&&(m._frameList=[i]),a&&(m.report(),m._frameList=[i]),m.timerId=window.setTimeout(function(){m.start()},100)},this.report=function(){var t,e,n,r,i,o,a,s,c,u,l={name:m.name,type:"post",event:{ev_type:"fps_jank_times",list:m._frameList,breadcrumbs:(null===(i=null===(r=null===(n=null===(e=null===(t=m._slardarInstance)||void 0===t?void 0:t.shared)||void 0===e?void 0:e.monitors)||void 0===n?void 0:n.BreadcrumbMonitor)||void 0===r?void 0:r.getBreadcrumbs)||void 0===i?void 0:i.call(r))||[],memory:(null===(u=null===(c=null===(s=null===(a=null===(o=m._slardarInstance)||void 0===o?void 0:o.shared)||void 0===a?void 0:a.monitors)||void 0===s?void 0:s.MemoryRecordMonitor)||void 0===c?void 0:c.getMemoryQueue)||void 0===u?void 0:u.call(c))||[]}};m._callback(l),W("FPSJankTimesMonitor Jank: ",l)},t&&t.slardarInstance&&(this._slardarInstance=t.slardarInstance),this._fpsMonitor=new F({mode:"frame"}),this._frameList=[],this.timerId=0,u(e=this.onLeave.bind(this))&&(u(window.addEventListener)&&(window.addEventListener("unload",e),window.addEventListener("beforeunload",e),window.addEventListener("pagehide",e)),u(document.addEventListener)&&document.addEventListener("visibilitychange",function(t){"hidden"===document.visibilityState&&e(t)})),n=this.onShow.bind(this),u(document.addEventListener)&&document.addEventListener("visibilitychange",function(t){"visible"===document.visibilityState&&n(t)})}var V=S(["bytecdn.cn","pstatp.com","snssdk.com","toutiao.com","365yg.com","byted.org"]),z=(K.prototype._sendHijackEvent=function(){u(this._callback)&&this._callback({name:this.name,type:"post",event:{ev_type:"hijack",events:this._events}})},K);function K(){var c=this;this.name="HijackMonitor",this.setup=function(t){e()&&(c._callback=t,c._start())},this._start=function(){k(function(){t()?setTimeout(function(){c._antiHijack()},2e3):c._antiHijack()})},this._antiHijack=function(){c._checkScripts(),c._checkIframe(),c._sendHijackEvent()},this._checkScripts=function(){for(var t=document.getElementsByTagName("script"),e=0;e<t.length;e++){var n=t[e];if(n.src){var r=m(n.src);c._inWhiteListDomain(r.hostname)||c._events.push({hijack_type:"script",hijack_host:r.host,hijack_content:n.src})}else c._inWhiteListContent(n.innerHTML)||c._events.push({hijack_type:"script",hijack_host:"unknown",hijack_content:n.innerHTML})}},this._checkIframe=function(){for(var t=document.getElementsByTagName("iframe"),e=0,n=t.length;e<n;e++){var r=t[e],i=r.src,o="about:blank";if(i&&i!==o){var a=m(i);0===a.protocol.indexOf("http")&&a.hostname&&c._inWhiteListIframeDomain(a.hostname)&&c._events.push({hijack_type:"iframe",hijack_host:a.host,hijack_content:i})}else if(i===o){var s="";try{r.contentDocument&&r.contentDocument.body&&r.contentDocument.body.innerHTML&&(s=r.contentDocument.body.innerHTML)}catch(t){s="Access is denied"}s&&c._events.push({hijack_type:"iframe",hijack_host:o,hijack_content:s})}}},this._inWhiteListDomain=function(t){return!(!V||!V.test(t))},this._inWhiteListContent=function(t){return!1},this._inWhiteListIframeDomain=function(t){return c._inWhiteListDomain(t)},this._events=[]}function $(){}var G=[],Y=function(t){var e=this;void 0===t&&(t=0),this.name="StaticPerformanceMonitor",this.setup=function(t){_()&&"function"==typeof performance.clearResourceTimings&&(e._isAsync&&window.performance.clearResourceTimings(),e._callback=t||function(){},k(function(){return e._sendPerformance()}))},this.getStaticPerformance=function(){return e._getPerformance()},this._getPerformance=function(){if(_()&&"function"==typeof performance.clearResourceTimings){var t=e._getParams();return{name:e.name,event:t}}},this._sendPerformance=function(){var t=e._getPerformance();u(e._callback)&&e._callback(t)},this._getParams=function(){return{resources:e._getResources()}},this._getResources=function(){return window.performance.getEntriesByType("resource").filter(function(t){return!function(t,e){if(f(t)&&0!==t.length)for(var n=0;n<t.length;){if(t[n]===e)return 1;n++}}(G,t.initiatorType)})},this._isAsync=t},Z=function(){var c=this;this.name="FIDMonitor",this.setup=function(t){if(g()&&PerformanceObserver.supportedEntryTypes&&PerformanceObserver.supportedEntryTypes.includes("first-input")&&w()){c._callback=t,c._observer=new PerformanceObserver(function(t,e){var n,r;try{for(var i=v(t.getEntries()),o=i.next();!o.done;o=i.next()){var a=o.value,s=a.processingStart-a.startTime;c._callback({name:c.name,fid:Math.round(s)})}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}e.disconnect()});try{c._observer.observe({type:"first-input",buffered:!0})}catch(t){c._observer.observe({entryTypes:["first-input"]})}}}},tt=function(t){var a=this;void 0===t&&(t=0),this.name="MPFIDMonitor",this._list=[],this.setup=function(){var e,t;if(y()&&w()){if(!a._isAsync){var n=window.Slardar&&window.Slardar.lt&&window.Slardar.lt.e;if(n&&0<n.length)try{for(var r=v(n),i=r.next();!i.done;i=r.next()){var o=i.value;"longtask"===o.entryType&&a._list.push(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}}a._observer=new PerformanceObserver(function(t){var e,n;try{for(var r=v(t.getEntries()),i=r.next();!i.done;i=r.next()){var o=i.value;a._list.push(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}}),a._observer.observe({entryTypes:["longtask"]})}},this._formatEvent=function(t){return{name:a.name,mpfid:t}},this.getMPFID=function(){var e,t;if(y()&&w()){a._observer&&a._observer.disconnect();var n=0;try{for(var r=v(a._list),i=r.next();!i.done;i=r.next()){var o=i.value;n<o.duration&&(n=o.duration)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(t=r.return)&&t.call(r)}finally{if(e)throw e.error}}return a._formatEvent(Math.round(n))}},this._isAsync=t},et=!1,nt=!1,rt=(it.prototype.getTTI=function(t){this._callback=t,y()&&b()&&w()?this._startSchedulingTimerTasks():this._callback&&"function"==typeof this._callback&&this._callback()},it.prototype._startSchedulingTimerTasks=function(){W("Enabling TTIDetector"),this._scheduleTimerTasks=!0;var t=0<this._longTasks.length?this._longTasks[this._longTasks.length-1].end:0,e=this._computeLastKnownNetwork2Busy(this._incompleteRequestStarts,this._networkRequests);this._rescheduleTimer(Math.max(e+5e3,t))},it.prototype._registerListeners=function(){et||(ot.patchXMLHTTPRequest(this._proxyConfig),et=!0),nt||(ot.patchFetch(this._proxyConfig),nt=!0),this._registerPerformanceObserver(),this._useMutationObserver&&(this._mutationObserver=ot.observeResourceFetchingMutations(this._mutationObserverCallback.bind(this)))},it.prototype._mutationObserverCallback=function(t){W("Potentially network resource fetching mutation detected",t),W("Pushing back TTI check by 5 seconds."),this._rescheduleTimer(performance.now()+5e3)},it.prototype._beforeJSInitiatedRequestCallback=function(t){W("Starting JS initiated request. Request ID: "+t),this._incompleteJSInitiatedRequestStartTimes[t]=performance.now(),W("Active XHRs: "+Object.keys(this._incompleteJSInitiatedRequestStartTimes).length)},it.prototype._afterJSInitiatedRequestCallback=function(t){W("Completed JS initiated request with request ID: "+t),this._incompleteJSInitiatedRequestStartTimes[t]=void 0,W("Active XHRs: "+Object.keys(this._incompleteJSInitiatedRequestStartTimes).length)},it.prototype._registerPerformanceObserver=function(){var s=this;this._performanceObserver=new PerformanceObserver(function(t){var e,n,r=t.getEntries();try{for(var i=v(r),o=i.next();!o.done;o=i.next()){var a=o.value;"resource"===a.entryType&&s._networkRequestFinishedCallback(a),"longtask"===a.entryType&&s._longTaskFinishedCallback(a)}}catch(t){e={error:t}}finally{try{o&&!o.done&&(n=i.return)&&n.call(i)}finally{if(e)throw e.error}}});try{this._performanceObserver.observe({type:"longtask"}),this._performanceObserver.observe({type:"resource",buffered:!0})}catch(t){this._performanceObserver.observe({entryTypes:["longtask","resource"]})}},it.prototype._networkRequestFinishedCallback=function(t){W("Network request finished",t),this._networkRequests.push({start:t.fetchStart,end:t.responseEnd}),this._rescheduleTimer(this._computeLastKnownNetwork2Busy(this._incompleteRequestStarts,this._networkRequests)+5e3)},Object.defineProperty(it.prototype,"_incompleteRequestStarts",{get:function(){for(var t=Object.keys(this._incompleteJSInitiatedRequestStartTimes),e=[],n=0;n<t.length;n++){var r=this._incompleteJSInitiatedRequestStartTimes[t[n]];"number"==typeof r&&e.push(r)}return e},enumerable:!0,configurable:!0}),it.prototype._longTaskFinishedCallback=function(t){W("Long task finished",t);var e=t.startTime+t.duration;this._longTasks.push({start:t.startTime,end:e}),this._rescheduleTimer(e+5e3)},it.prototype._rescheduleTimer=function(t){var e=this;this._scheduleTimerTasks?(W("Attempting to reschedule TTI check to "+t),W("Previous timer activation time: "+this._timerActivationTime),this._timerActivationTime>t?W("Current activation time is greater than attempted reschedule time. No need to postpone."):(clearTimeout(this._timerId),this._timerId=window.setTimeout(function(){e._checkTTI()},t-performance.now()),this._timerActivationTime=t,W("Rescheduled TTI check at "+t))):W("startSchedulingTimerTasks must be called before calling rescheduleTimer")},it.prototype._checkTTI=function(){W("Checking if TTI was reached...");var t=this._computeLastKnownNetwork2Busy(this._incompleteRequestStarts,this._networkRequests),e=this._getFirstPaintTime()||performance.timing.domContentLoadedEventEnd-performance.timing.navigationStart,n=this._getMinValue(),r=performance.now();null===n&&(W("No usable minimum value yet. Postponing check."),this._rescheduleTimer(Math.max(t+5e3,r+1e3))),W("Parameter values:"),W("lastKnownNetwork2Busy",t),W("Search Start",e),W("Min Value",n),W("Last busy",t),W("Current time",r),W("Long tasks",this._longTasks),W("Incomplete JS Request Start Times",this._incompleteRequestStarts),W("Network requests",this._networkRequests);var i=this._computeTTI(e,n,t,r,this._longTasks);i?(this._callback&&"function"==typeof this._callback&&this._callback(Math.round(i)),this._disable()):(W("Could not detect TTI. Retrying in 1 second."),this._rescheduleTimer(performance.now()+1e3))},it.prototype._getMinValue=function(){if(this._minValue)return this._minValue;if(performance.timing.domContentLoadedEventEnd){var t=performance.timing;return t.domContentLoadedEventEnd-t.navigationStart}return null},it.prototype._getFirstPaintTime=function(){if("PerformancePaintTiming"in window){var t=performance.getEntriesByType("paint")[0];return t?t.startTime:0}return 0},it.prototype._disable=function(){W("Disabling TTIDetector"),clearTimeout(this._timerId),this._scheduleTimerTasks=!1,this._unregisterListeners(),this._snippetObserver&&this._snippetObserver.disconnect(),this._snippetEntries&&this._snippetEntries.splice(0,this._snippetEntries.length)},it.prototype._unregisterListeners=function(){this._performanceObserver&&this._performanceObserver.disconnect(),this._mutationObserver&&this._mutationObserver.disconnect(),ot.resetOriginals(),this._proxyConfig&&(this._proxyConfig.beforeCb=$,this._proxyConfig.afterCb=$)},it.prototype._computeLastKnownNetwork2Busy=function(t,e){var n,r,i,o;if(2<t.length)return performance.now();var a=[];try{for(var s=v(e),c=s.next();!c.done;c=s.next()){var u=c.value;a.push({timestamp:u.start,type:"requestStart"}),a.push({timestamp:u.end,type:"requestEnd"})}}catch(t){n={error:t}}finally{try{c&&!c.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}try{for(var l=v(t),m=l.next();!m.done;m=l.next()){var d=m.value;a.push({timestamp:d,type:"requestStart"})}}catch(t){i={error:t}}finally{try{m&&!m.done&&(o=l.return)&&o.call(l)}finally{if(i)throw i.error}}a.sort(function(t,e){return t.timestamp-e.timestamp});for(var h=t.length,f=a.length-1;0<=f;f--){var p=a[f];switch(p.type){case"requestStart":h--;break;case"requestEnd":if(2<++h)return p.timestamp;break;default:throw Error("Internal Error: This should never happen")}}return 0},it);function it(t){var e,n;if(void 0===t&&(t={isAsync:0}),this.name="TTIMonitor",this._useMutationObserver=!0,this._isAsync=0,this._longTasks=[],this._networkRequests=[],this._incompleteJSInitiatedRequestStartTimes={},this._timerActivationTime=-1/0,this._scheduleTimerTasks=!1,this._proxyConfig={beforeCb:this._beforeJSInitiatedRequestCallback.bind(this),afterCb:this._afterJSInitiatedRequestCallback.bind(this)},this.setup=function(){},this._computeTTI=function(t,e,n,r,i){if(r-n<5e3)return null;var o=0===i.length?t:i[i.length-1].end;return r-o<5e3?null:Math.max(o,e)},y()&&b()&&w()){if(this._useMutationObserver=!!t.useMutationObserver,this._minValue=t.minValue||null,this._isAsync=t.isAsync,this._snippetEntries=window.Slardar&&window.Slardar.lt&&window.Slardar.lt.e,this._snippetObserver=window.Slardar&&window.Slardar.lt&&window.Slardar.lt.o,!this._isAsync&&this._snippetEntries&&0<this._snippetEntries.length)try{for(var r=v(this._snippetEntries),i=r.next();!i.done;i=r.next()){var o=i.value;"longtask"===o.entryType?this._longTasks.push({start:o.startTime,end:o.startTime+o.duration}):"resource"===o.entryType&&this._networkRequests.push({start:o.fetchStart,end:o.responseEnd})}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}this._registerListeners()}}var ot={uniqueId:0,originals:{},proxies:{},patchXMLHTTPRequest:function(o){this.originals.send=XMLHttpRequest.prototype.send,XMLHttpRequest.prototype.send=function(){for(var e=this,t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];var r=ot.uniqueId++;o.beforeCb(r);var i=this.onreadystatechange;return this.onreadystatechange=function(t){i&&i.call(e,t),4===e.readyState&&o.afterCb(r)},ot.originals.send.apply(this,t)},this.proxies.send=XMLHttpRequest.prototype.send},patchFetch:function(i){if(function(){if("fetch"in window)try{return new Headers,new Request(""),new Response,1}catch(t){return}}()){var o=window.fetch;this.originals.fetch=o,window.fetch=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return new Promise(function(e,n){var r=ot.uniqueId++;i.beforeCb(r),o.apply(void 0,c(t)).then(function(t){i.afterCb(r),e(t)},function(t){i.afterCb(r,t),n(t)})})},this.proxies.fetch=window.fetch}},observeResourceFetchingMutations:function(a){if(e()&&"function"==typeof window.MutationObserver){var s=["img","script","iframe","link","audio","video","source"],t=new MutationObserver(function(t){var e,n;try{for(var r=v(t),i=r.next();!i.done;i=r.next()){var o=i.value;("childList"===o.type&&c(o.addedNodes,s)||"attributes"===o.type&&s.includes(o.target.nodeName.toLowerCase()))&&a(o)}}catch(t){e={error:t}}finally{try{i&&!i.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}});return t.observe(document,{attributes:!0,childList:!0,subtree:!0,attributeFilter:["href","src"]}),t}function c(t,e){var n,r;try{for(var i=v(t),o=i.next();!o.done;o=i.next()){var a=o.value;if(e.includes(a.nodeName.toLowerCase())||a.children&&c(a.children,e))return 1}}catch(t){n={error:t}}finally{try{o&&!o.done&&(r=i.return)&&r.call(i)}finally{if(n)throw n.error}}}},resetOriginals:function(){this.originals.send&&XMLHttpRequest.prototype.send===this.proxies.send&&(et=!1,XMLHttpRequest.prototype.send=this.originals.send),this.originals.fetch&&fetch===this.proxies.fetch&&(nt=!1,window.fetch=this.originals.fetch)}},at={ev_type:"perf",isAsync:0,dns:0,tcp:0,request:0,response:0,processing:0,blank:0,domready:0,load:0,has_resource:0,navigation:{},domparse:0,resource:0,ttfb:0,redirct:0},st=(ct.prototype.send=function(){var t=this;this._initFlag&&this._hasLoaded&&(this._sendParams.isAsync&&(this._sendParams.load=Math.round(this._performanceNow()-this._initStart)),setTimeout(function(){t._perfLog()},200))},ct.prototype.initAsync=function(){var t,e;this._hasSentInitPerf&&(this._sendParams=s({},at),this._sendParams.isAsync=1,this._initFlag=!0,this._initStart=this._performanceNow(),this._slardarInstance&&this._slardarInstance.shared&&this._slardarInstance.shared.performanceUserTiming&&this._slardarInstance.shared.performanceUserTiming.clear(),this._staticPerformanceMonitor=new Y(1),this._staticPerformanceMonitor.setup(),this._mpfidMonitor=new tt(1),this._mpfidMonitor.setup(),this._ttiMonitor=new rt({minValue:Math.round(this._performanceNow()),isAsync:1}),this._ttiMonitor.setup(),null!==(e=null===(t=this._fmpMonitor)||void 0===t?void 0:t.setup)&&void 0!==e&&e.call(t))},ct.prototype._performanceNow=function(){return performance&&performance.now?performance.now():(Date.now?Date.now():+new Date)-(performance.timing&&performance.timing.navigationStart?performance.timing.navigationStart:0)},ct);function ct(t){var e,n,r,i,h=this;if(this.name="PerformanceMonitor",this._sendParams=s({},at),this._hasLoaded=!1,this._initStart=0,this._hasSentInitPerf=!1,this._initFlag=!0,this._performanceAuto=!0,this._renderType=0,this.setup=function(t){var e,n,r;p()&&(h._callback=t,k(function(){(h._hasLoaded=!0)===h._performanceAuto&&setTimeout(function(){h._perfLog()},200)}),h._sendParams=s({},at),h._staticPerformanceMonitor=new Y,h._staticPerformanceMonitor.setup(),(new Z).setup(h._hasFID),h._mpfidMonitor=new tt,h._mpfidMonitor.setup(),h._ttiMonitor=new rt,h._ttiMonitor.setup(),h._fmpMonitor=null===(r=null===(n=null===(e=h._slardarInstance)||void 0===e?void 0:e.shared)||void 0===n?void 0:n.monitors)||void 0===r?void 0:r.FMPMonitor,window.addEventListener("beforeunload",h._syncPerfLog),window.addEventListener("unload",h._syncPerfLog),window.addEventListener("pagehide",h._syncPerfLog),u(document.addEventListener)&&document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&h._syncPerfLog()}))},this._syncPerfLog=function(){h._hasSentInitPerf||(h._perfLog(!0),h._slardarInstance("report"))},this._parseRenderType=function(){var t,e,n,r,i,o,a,s,c=null===(o=null===(i=null===(r=null===(n=null===(e=null===(t=h._slardarInstance)||void 0===t?void 0:t.shared)||void 0===e?void 0:e.config)||void 0===n?void 0:n.monitors)||void 0===r?void 0:r.BaseMonitor)||void 0===i?void 0:i.appTypeSetting)||void 0===o?void 0:o.renderType,u=null===(s=null===(a=h._slardarInstance)||void 0===a?void 0:a.shared)||void 0===s?void 0:s.config.commonParams.pid;if(!c||!u)return 0;for(var l=0;l<c.length;l++){var m=c[l];if(f(m.pids)&&0<m.pids.length){var d=S(m.pids);if(d&&d.test(u))return m.value}if(m.isDefault&&l===c.length-1)return m.value}return 0},this._hasFID=function(t){h._sendParams.fid=t.fid},this._getParams=function(){if(p()){var t={},e=window.performance.timing;t.dns=e.domainLookupEnd-e.domainLookupStart,t.tcp=e.connectEnd-e.connectStart,t.request=e.responseStart-e.requestStart,t.response=e.responseEnd-e.responseStart,t.processing=e.domComplete-e.domLoading,t.blank=e.responseEnd-e.navigationStart,t.domready=e.domInteractive-e.navigationStart,t.load=e.loadEventEnd-e.navigationStart,e.secureConnectionStart&&(t.ssl=e.connectEnd-e.secureConnectionStart),t.domparse=e.domInteractive-e.responseEnd,t.resource=e.loadEventStart-e.domContentLoadedEventEnd,t.ttfb=e.responseStart-e.requestStart,t.redirct=e.redirectEnd-e.redirectStart;var n=h._getPaintTime("first-paint"),r=h._getPaintTime("first-contentful-paint");n&&(t.fp=Math.round(n)),r&&(t.fcp=Math.round(r));var i=function(){if(!_())return null;var t=window.performance.getEntriesByType("navigation");return f(t)&&0!==t.length?t[0]:null}(),o=p()?window.performance.timing:null;return(i||o)&&(t.navigation=i||o),o&&(t.timing=o),i&&(t.navigation_timing=i),t}},this._getPaintTime=function(e){if(_()){var t=performance.getEntriesByType("paint");if(f(t)){var n=t.filter(function(t){return t.name===e});return n.length&&n[0]&&a(n[0])&&n[0].startTime||0}}return 0},this._perfLog=function(t){if(void 0===t&&(t=!1),p()){h._initFlag=!1;var e=s({},h._sendParams);if(!h._sendParams.isAsync){var n=h._getBounced();if(n)return e.bounced=n,void h._invokeCallback(!1,{name:h.name,type:"post",event:e});e=s(s({},e),h._getParams())}var r=h._getStaticResources(),i=h._getFMP(),o=h._getMPFID(),a=h._getUserTiming();r&&(e.resources=r,e.has_resource=1),i&&(e.fmp=Math.round(i)),i&&e.fcp&&e.fmp<e.fcp&&(e.fmp=e.fcp),o&&(e.mpfid=o),a&&(e=s(s({},e),a)),u(h._callback)&&(!t&&h._ttiMonitor&&u(h._ttiMonitor.getTTI)?h._ttiMonitor.getTTI(function(t){t&&0<t&&(e.tti=e.isAsync?Math.round(t-h._initStart):t),h._invokeCallback(e.isAsync,{name:h.name,type:"post",event:e})}):h._invokeCallback(e.isAsync,{name:h.name,type:"post",event:e}))}},this._invokeCallback=function(t,e){if(!t){if(h._hasSentInitPerf)return;h._hasSentInitPerf=!0}h._callback(e)},this._getBounced=function(){return!h._hasLoaded},this._getStaticResources=function(){if(h._staticPerformanceMonitor&&u(h._staticPerformanceMonitor.getStaticPerformance)){var t=h._staticPerformanceMonitor.getStaticPerformance();if(t&&t.event&&t.event.resources)return t.event.resources||[]}},this._getFMP=function(){var t,e,n,r;return h._fmpMonitor?(null!==(e=null===(t=h._fmpMonitor)||void 0===t?void 0:t.disconnect)&&void 0!==e&&e.call(t),h._sendParams.isAsync?(r=null===(n=h._fmpMonitor)||void 0===n?void 0:n.getFmp())&&r.event&&r.event.fmp||0:u(h._fmpMonitor.getLoadFmp)?1!==h._renderType?2===h._renderType?h._getPaintTime("first-contentful-paint"):0:(r=h._fmpMonitor.getLoadFmp()||{}).event&&r.event.fmp||0:0):0},this._getMPFID=function(){if(h._mpfidMonitor&&u(h._mpfidMonitor.getMPFID)){var t=h._mpfidMonitor.getMPFID();if(t)return t.mpfid}},this._getUserTiming=function(){var t={};return h._slardarInstance&&h._slardarInstance.shared&&h._slardarInstance.shared.performanceUserTiming&&(t=h._slardarInstance.shared.performanceUserTiming.getUserTiming()||{}),t},t&&t.slardarInstance){this._slardarInstance=t.slardarInstance;var o=null===(i=null===(r=null===(n=null===(e=this._slardarInstance)||void 0===e?void 0:e.shared)||void 0===n?void 0:n.config)||void 0===r?void 0:r.commonParams)||void 0===i?void 0:i.performanceAuto;this._performanceAuto=void 0===o||o,this._renderType=this._parseRenderType()}}var ut=function(t){var o=this;this.name="StaticErrorMonitor",this.setup=function(t){e()&&(o._callback=t,window.addEventListener("error",o.staticErrorLog,!0))},this._getParams=function(t,e){var n={ev_type:"static",st_type:e},r=m(t);return n.st_src=t,n.st_protocol=r.protocol,n.st_domain=r.hostname,n.st_path=r.pathname,n},this.getSrc=function(t){return t&&u(t.getAttribute)?t.getAttribute("src"):t.src||t.href||""},this.staticErrorLog=function(t){var e=o.buildEvent(t);o._callback(e)},this.buildEvent=function(t){var e,n=t||window.event||{};try{e=n.target||n.srcElement||{}}catch(n){return}var r=o.getSrc(e),i=e.tagName&&e.tagName.toLowerCase()||"";if(r&&i&&r!==window.location.href)return{name:o.name,type:"get",event:o._getParams(r,i)}},null!=t&&t.slardarInstance&&(this._slardarInstance=t.slardarInstance)},lt=(mt.prototype.addon=function(i){var o=this;i&&(this._emit=function(){var t,e,n,r=null!==(n=null===(e=null===(t=i.monitors)||void 0===t?void 0:t.WorkerMonitor)||void 0===e?void 0:e.worker)&&void 0!==n?n:void 0;r&&r.postMessage({type:"memoryRecord",memoryInfo:o._memoryQueue})})},mt.prototype._report=function(){var t=window.performance.memory;this._add({jsHeapSizeLimit:t.jsHeapSizeLimit,totalJSHeapSize:t.totalJSHeapSize,usedJSHeapSize:t.usedJSHeapSize,timestamp:L()})},mt.prototype._start=function(){this._report()},mt.prototype._add=function(t){this._memoryQueue.length>=this._maxQueue&&this._memoryQueue.shift(),this._memoryQueue.push(t),this._emit&&this._emit()},mt.prototype.report=function(){return this._memoryQueue.map(function(t){return s({},t)})},mt.prototype.getMemoryQueue=function(){return this._memoryQueue},mt);function mt(t){var e,n,r=this;this.name="MemoryRecordMonitor",this._emit=null,this.setup=function(){d()&&window.performance.memory&&(r._executor=setInterval(function(){r._start()},r._timeout))},this._timeout=null!==(e=null==t?void 0:t.interval)&&void 0!==e?e:1e3,this._maxQueue=null!==(n=null==t?void 0:t.maxQueue)&&void 0!==n?n:10,this._memoryQueue=[]}var dt=(ht.prototype.emitEvent=function(t){var e=this._buildEmitSingleEvent(t);this._callback(e)},ht);function ht(){var o=this;this.name="EmitMonitor",this._callback=T,this.setup=function(t){o._callback=t||T},this.handOut=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=o.buildEvent.apply(o,c(t));o._callback(n)},this.buildEvent=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if("sendCustomCountLog"===t[0])return o._buildCustomCountLog(t[1],t[2]);if("sendCustomTimeLog"===t[0])return o._buildCustomTimeLog(t[1],t[2],t[3]);if("send"===t[0]){if("count"===t[1])return o._buildCustomCountLog(t[2].category,t[2].action);if("timing"===t[1])return o._buildCustomTimeLog(t[2].category,t[2].action,t[2].value)}if("emit"!==t[0])return{};if(t[1]&&t[2]){var n={type:t[1],event:t[2]};return o._buildEmitSingleEvent(n)}},this.send=function(t,e,n){var r=n.action,i=n.value;"count"===t&&o.sendCustomCountLog(e,r),"timing"===t&&o.sendCustomTimeLog(e,r,i)},this._buildCustomTimeLog=function(t,e,n){return function(t){var e=t.name,n=t.tag,r=t.value;if(e&&r){var i={ev_type:"custom",cm_name:e=u(e.toString)?e.toString():"",cm_type:"time",cm_value:r=+r};return n&&(n=u(n.toString)?n.toString():"",i.cm_tag=n),{name:"SentCustomTime",type:"get",event:i}}}({name:t,tag:e,value:n})},this.sendCustomTimeLog=function(t,e,n){var r=o._buildCustomTimeLog(t,e,n);o._callback(r)},this._buildCustomCountLog=function(t,e){return function(t){var e=t.name,n=t.tag;if(e){var r={ev_type:"custom",cm_name:e=u(e.toString)?e.toString():"",cm_type:"count"};return n&&(n=u(n.toString)?n.toString():"",r.cm_tag=n),{name:"SentCustomCount",type:"get",event:r}}}({name:t,tag:e})},this.sendCustomCountLog=function(t,e){var n=o._buildCustomCountLog(t,e);return o._callback(n),n},this._buildEmitSingleEvent=function(t){var e,n,r=(n=null,a(e=t)&&("timer"===e.type&&(n=N(e.event)),"counter"===e.type&&(n=J(e.event)),"log"===e.type&&(n=B(e.event)),"custom"===e.type&&(n=U(e.event))),n);return!r||r&&!r.event_name?{}:{name:o.name,type:"post",event:{ev_type:"flexible",flexible_data_list:[r]}}}}var ft=function(){var i=this;this.name="BreadcrumbMonitor",this._breadcrumbs=[],this.setup=function(t){i._callback=t||T,i.instrumentDOM()},this.getBreadcrumbs=function(){return i._breadcrumbs},this.instrumentDOM=function(){if("document"in window){var t=i;window.document.addEventListener("click",t.domEventHandler("click",t.triggerHandlers.bind(null,"dom")),!1),window.document.addEventListener("keypress",t.keypressEventHandler(t.triggerHandlers.bind(null,"dom")),!1)}},this.domEventHandler=function(e,n,r){return void 0===r&&(r=!1),function(t){i.keypressTimeout=void 0,t&&i.lastCapturedEvent!==t&&(i.lastCapturedEvent=t,i.debounceTimer&&clearTimeout(i.debounceTimer),r?i.debounceTimer=setTimeout(function(){n({event:t,name:e})}):n({event:t,name:e}))}},this.triggerHandlers=function(e,t){if(e)try{i.domBreadcrumb(t)}catch(t){W("Error while triggering instrumentation handler.\nType: "+e+"\nName: "+function(t){var e="<anonymous>";try{return t&&"function"==typeof t&&t.name||e}catch(t){return e}}(i.domBreadcrumb)+"\nError: "+t)}},this.keypressEventHandler=function(r){return function(t){var e;try{e=t.target}catch(t){return}var n=e&&e.tagName;n&&("INPUT"===n||"TEXTAREA"===n||e.isContentEditable)&&(i.keypressTimeout||i.domEventHandler("input",r)(t),clearTimeout(i.keypressTimeout),i.keypressTimeout=setTimeout(function(){i.keypressTimeout=void 0},i.debounceDuration))}},this.domBreadcrumb=function(t){var e;try{e=t.event.target?j(t.event.target):j(t.event)}catch(t){e="<unknown>"}0!==e.length&&i.addBreadcrumb({category:"ui."+t.name,message:e})},this.addBreadcrumb=function(t,e){var n=s({timestamp:L()},t);return i._breadcrumbs=void 0!==e&&0<=e?c(i._breadcrumbs,[n]).slice(-e):c(i._breadcrumbs,[n]),W("Breadcrumbs: ",i._breadcrumbs),i},this.debounceDuration=1e3,this.debounceTimer=0,this._breadcrumbs=[]},pt="/toutiao/slardar/sdk/plugins/browser",vt="https://"+"s3a.pstatp.com"+pt+"/worker.3.0.11.js",_t="https://"+"s16.hypstarcdn.com"+pt+"/worker.3.0.11.js",gt=function(r){void 0===r&&(r=window);var i=0;return{setSchedule:function(t,e){var n=this;i=r.setTimeout(function(){t(),n.setSchedule(t,e)},e)},clearSchedule:function(){r.clearTimeout(i)},getTimer:function(){return i}}}(),yt=function(t){var n=this;this.name="WorkerMonitor",this.setup=function(){u(window.Worker)&&n._loadWorker()},this._loadWorker=function(){M.get(n._options.workerLink||vt,{getResponseText:function(t){var e=new Worker(window.URL.createObjectURL(new Blob([t],{type:"text/javascript"})));n.worker=e,document.addEventListener("visibilitychange",function(){n._sendVisibilityChange({worker:e,visibilityState:document.visibilityState})}),gt.setSchedule(function(){n._heartBeat({worker:e,reportURL:n._options.reportURL,commonParams:n._options.commonParams})},2e3)}})},this._sendVisibilityChange=function(t){var e=t.worker,n=t.visibilityState;e.postMessage({type:"visibilityChange",visibilityState:n})},this._heartBeat=function(t){var e=t.worker,n=t.reportURL,r=t.commonParams;e.postMessage({type:"heartBeat",reportURL:n,commonParams:s(s({},r||{}),{url:window.location.href})})},this._options=t,this.worker=null};function bt(t,e){if(!a(t)||!a(e))return{};var n=s({},t||{});return n.event=s(s({},(null==t?void 0:t.event)||{}),e||{}),n}(new function(){var s=this;this.init=function(){var t,e,n=s._shared.config||{};n.commonParams.enableStaticError&&s._monitors.push(new ut),n.commonParams.enablePerformance&&s._monitors.push(new st({slardarInstance:window.Slardar})),n.commonParams.enableMemoryRecord&&s._monitors.push(new lt),n.commonParams.enableFPSJankTimesMonitor&&s._monitors.push(new Q({slardarInstance:window.Slardar})),s._monitors.push(new z),s._monitors.push(new dt),s._monitors.push(new yt({reportURL:null===(t=null===n?void 0:n.commonParams)||void 0===t?void 0:t.reportURLSingle,commonParams:null===n?void 0:n.commonParams,workerLink:null!==(e=null===n?void 0:n.commonParams)&&void 0!==e&&e.domestic?vt:_t})),n.commonParams.enableBreadcrumb&&s._monitors.push(new ft),s._shared&&s._shared.monitors&&o(s._monitors,function(t,e){s._shared.monitors[e.name]=e}),s._setup(),s._handlePreCollect()},this._setup=function(){s._shared&&s._shared.sendEvent&&s._monitors.forEach(function(t){t.addon&&t.addon(s._shared),t.setup(s._shared.sendEvent)})},this._handlePreCollect=function(){var t=s._shared.collect,e=(null==t?void 0:t.emit)||[];f(e)&&o(e,function(t,e){var n,r;if(e&&null!=e&&e.event&&null!=e&&e.params){var i=e.event,o=e.params,a=bt((null===(r=null===(n=s._shared.monitors)||void 0===n?void 0:n.EmitMonitor)||void 0===r?void 0:r.buildEvent.apply(r,c(i||{})))||{},o);s._shared.sendEvent(a)}});var n=(null==t?void 0:t.staticError)||[];f(n)&&n.forEach(function(t){var e,n;if(t&&null!=t&&t.event&&null!=t&&t.params){var r=t.event,i=t.params,o=bt((null===(n=null===(e=s._shared.monitors)||void 0===e?void 0:e.StaticErrorMonitor)||void 0===n?void 0:n.buildEvent)(r||{})||{},i);s._shared.sendEvent(o)}})},this._shared=window.Slardar&&window.Slardar.shared||{},this._monitors=[]}).init()}();
