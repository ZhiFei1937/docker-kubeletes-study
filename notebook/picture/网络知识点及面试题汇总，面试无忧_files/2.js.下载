(window["bytedance_secsdk_captcha_jsonp_2.8.12"]=window["bytedance_secsdk_captcha_jsonp_2.8.12"]||[]).push([[2],{386:function(e,t,i){"use strict";i.r(t),i.d(t,"Collector",function(){return Be});var n=function(){return(n=Object.assign||function(e){for(var t,i=1,n=arguments.length;i<n;i++)for(var r in t=arguments[i])Object.prototype.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e}).apply(this,arguments)};function r(e,t){var i={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(i[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var r=0;for(n=Object.getOwnPropertySymbols(e);r<n.length;r++)t.indexOf(n[r])<0&&(i[n[r]]=e[n[r]])}return i}function o(e,t){var i="function"==typeof Symbol&&e[Symbol.iterator];if(!i)return e;var n,r,o=i.call(e),s=[];try{for(;(void 0===t||t-- >0)&&!(n=o.next()).done;)s.push(n.value)}catch(e){r={error:e}}finally{try{n&&!n.done&&(i=o.return)&&i.call(o)}finally{if(r)throw r.error}}return s}function s(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(o(arguments[t]));return e}var a,c=function(e,t){var i,n,r=function(e){var t=document.createElement("a");return t.href=e,t},o=window.screen.width,s=window.screen.height,a=window.navigator.appVersion,c=window.navigator.userAgent,u=window.navigator.language,h=document.referrer,d=h?r(h).hostname:"",l=function(e){var t=r(e).search;t=t.slice(1);var i={};return t.split("&").forEach(function(e){var t,n,r=e.split("=");r.length&&(t=r[0],n=r[1]),i[t]=decodeURIComponent(void 0===n?"":n)}),i}(window.location.href),p="",f="",_="",v=""+parseFloat(a);-1!==(i=c.indexOf("Opera"))&&(_="Opera",v=c.substring(i+6),-1!==(i=c.indexOf("Version"))&&(v=c.substring(i+8))),-1!==(i=c.indexOf("Edge"))?(_="Microsoft Edge",v=c.substring(i+5)):-1!==(i=c.indexOf("MSIE"))?(_="Microsoft Internet Explorer",v=c.substring(i+5)):-1!==c.indexOf("Chrome")?-1!==(i=c.indexOf("MicroMessenger"))?(_="weixin",v=c.substring(i+15,i+20)):-1!==(i=c.indexOf("MQQBrowser"))?(_="qqbrowser",v=c.substring(i+11,i+15)):-1!==(i=c.indexOf("Chrome"))&&(_="Chrome",v=c.substring(i+7)):-1!==c.indexOf("Safari")?-1!==(i=c.indexOf("QQ"))?(_="qqbrowser",v=c.substring(i+10,i+16)):-1!==(i=c.indexOf("Safari"))&&(_="Safari",v=c.substring(i+7),-1!==(i=c.indexOf("Version"))&&(v=c.substring(i+8))):-1!==(i=c.indexOf("Firefox"))?(_="Firefox",v=c.substring(i+8)):-1!==(i=c.indexOf("MicroMessenger"))?(_="weixin",v=c.substring(i+15,i+20)):-1!==(i=c.indexOf("QQ"))&&(_="qqbrowser",v=c.substring(i+3,i+8)),-1!==(n=v.indexOf(";"))&&(v=v.substring(0,n)),-1!==(n=v.indexOf(" "))&&(v=v.substring(0,n)),-1!==(n=v.indexOf(")"))&&(v=v.substring(0,n));for(var g,m,y=/Mobile|htc|mini|Android|iP(ad|od|hone)/.test(a)?"wap":"web",w=[{s:"Windows 10",r:/(Windows 10.0|Windows NT 10.0)/},{s:"Windows 8.1",r:/(Windows 8.1|Windows NT 6.3)/},{s:"Windows 8",r:/(Windows 8|Windows NT 6.2)/},{s:"Windows 7",r:/(Windows 7|Windows NT 6.1)/},{s:"Android",r:/Android/},{s:"Sun OS",r:/SunOS/},{s:"Linux",r:/(Linux|X11)/},{s:"iOS",r:/(iPhone|iPad|iPod)/},{s:"Mac OS X",r:/Mac OS X/},{s:"Mac OS",r:/(MacPPC|MacIntel|Mac_PowerPC|Macintosh)/}],b=0;b<w.length;b++){var k=w[b];if(k.r.test(c)){p=k.s;break}}function S(e,t){var i=e.exec(t);return i&&i[1]?i[1]:""}switch(/Windows/.test(p)&&(f=S(/Windows (.*)/,p),p="windows"),p){case"Mac OS X":f=S(/Mac OS X (10[\.\_\d]+)/,c),p="mac";break;case"Android":(m=S(/Android ([\.\_\d]+)/,g=c))||(m=S(/Android\/([\.\_\d]+)/,g)),f=m,p="android";break;case"iOS":f=(f=/OS (\d+)_(\d+)_?(\d+)?/.exec(a))?f[1]+"."+f[2]+"."+(0|f[3]):"",p="ios"}var I=e?function(){var e=t?"_tea_utm_cache_"+t:"_tea_utm_cache",i={},n={utm_source:l.utm_source,utm_medium:l.utm_medium,utm_campaign:l.utm_campaign,utm_term:l.utm_term,utm_content:l.utm_content};try{var r=window.sessionStorage,o=!1;for(var s in n)n[s]&&(i[s]=n[s],o=!0);if(o)r.setItem(e,JSON.stringify(i));else{var a=r.getItem(e);a&&(i=JSON.parse(a))}}catch(e){return n}return i}():{};return{browser:_,browser_version:v,platform:y,os_name:p,os_version:f,userAgent:c,screen_width:o,screen_height:s,device_model:function(e){var t="";try{if("android"===e)navigator.userAgent.split(";").forEach(function(e){e.indexOf("Build/")>-1&&(t=e.slice(0,e.indexOf("Build/")))});else if("ios"===e||"mac"===e){var i=navigator.userAgent.replace("Mozilla/5.0 (",""),n=i.indexOf(";");t=i.slice(0,n)}}catch(e){}return t.trim()}(p),language:u,referrer:h,referrer_host:d,utm_source:I.utm_source,utm_medium:I.utm_medium,utm_campaign:I.utm_campaign,utm_term:I.utm_term,utm_content:I.utm_content,isSupportBeacon:("ios"!==p||"safari"!==_)&&(!(!window.navigator||!window.navigator.sendBeacon)||void 0)}},u=(function(e,t){var i;i=function(){function e(){for(var e=0,t={};e<arguments.length;e++){var i=arguments[e];for(var n in i)t[n]=i[n]}return t}function t(e){return e.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function i(n){function r(){}function o(t,i,o){if("undefined"!=typeof document){"number"==typeof(o=e({path:"/"},r.defaults,o)).expires&&(o.expires=new Date(1*new Date+864e5*o.expires)),o.expires=o.expires?o.expires.toUTCString():"";try{var s=JSON.stringify(i);/^[\{\[]/.test(s)&&(i=s)}catch(e){}i=n.write?n.write(i,t):encodeURIComponent(String(i)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),t=encodeURIComponent(String(t)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var a="";for(var c in o)o[c]&&(a+="; "+c,!0!==o[c]&&(a+="="+o[c].split(";")[0]));return document.cookie=t+"="+i+a}}function s(e,i){if("undefined"!=typeof document){for(var r={},o=document.cookie?document.cookie.split("; "):[],s=0;s<o.length;s++){var a=o[s].split("="),c=a.slice(1).join("=");i||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var u=t(a[0]);if(c=(n.read||n)(c,u)||t(c),i)try{c=JSON.parse(c)}catch(e){}if(r[u]=c,e===u)break}catch(e){}}return e?r[e]:r}}return r.set=o,r.get=function(e){return s(e,!1)},r.getJSON=function(e){return s(e,!0)},r.remove=function(t,i){o(t,"",e(i,{expires:-1}))},r.defaults={},r.withConverter=i,r}(function(){})},e.exports=i()}(a={exports:{}}),a.exports),h=function(){function e(){this.cache={}}return e.prototype.setItem=function(e,t){this.cache[e]=t},e.prototype.getItem=function(e){return this.cache[e]},e.prototype.removeItem=function(e){this.cache[e]=void 0},e}(),d={getItem:function(e){try{var t=localStorage.getItem(e),i=t;try{t&&"string"==typeof t&&(i=JSON.parse(t))}catch(e){}return i||void 0}catch(e){}},setItem:function(e,t){try{var i="string"==typeof t?t:JSON.stringify(t);localStorage.setItem(e,i)}catch(e){}},removeItem:function(e){try{localStorage.removeItem(e)}catch(e){}},getCookie:function(e){try{var t=document.cookie.match(new RegExp("(?:^|;)\\s*"+e+"=([^;]+)")),i=t?t[1]:"";return decodeURIComponent(i)}catch(e){return""}},setCookie:function(e,t,i){try{var n=+new Date+i;u.set(e,t,{expires:new Date(n),path:"/",domain:document.domain.split(".").slice(-2).join(".")})}catch(e){}},isSupportLS:function(){try{return localStorage.setItem("_ranger-test-key","hi"),localStorage.getItem("_ranger-test-key"),localStorage.removeItem("_ranger-test-key"),!0}catch(U){return!1}}()},l=function(){function e(e){this._storage=!e&&d.isSupportLS?d:new h}return e.prototype.getItem=function(e){return this._storage.getItem(e)},e.prototype.setItem=function(e,t){this._storage.setItem(e,t)},e.prototype.getCookie=function(e){return this._storage.getCookie(e)},e.prototype.setCookie=function(e,t,i){this._storage.setCookie(e,t,i)},e.prototype.removeItem=function(e){this._storage.removeItem(e)},e}(),p={cn:"https://mcs.snssdk.com",sg:"https://sgali-mcs.byteoversea.com",va:"https://maliva-mcs.byteoversea.com"},f="/v1/user/webid",_="/v1/list",v={NO_URL:4001,IMG_ON:4e3,IMG_CATCH:4002,BEACON_FALSE:4003,XHR_ON:500,RESPONSE:5001},g=function(e,t){return t?"__tea_cache_tokens_"+e:"__tea_cache_events_"+e},m=function(){if("undefined"!=typeof window)return window.TeaAnalyticsObject},y={cn:"https://dpprofile.snssdk.com",sg:"https://sgali-dpprofile.byteoversea.com",va:"https://vaali-dpprofile.byteoversea.com"},w={cn:"https://toblog.ctobsnssdk.com",va:"https://toblog.itobsnssdk.com",sg:"https://toblog.tobsnssdk.com"},b="__shushuo_libra_style__";function k(e,t,i,n,r,o,s){var a=new XMLHttpRequest;o&&(a.timeout=o);var c=s||"POST";a.open(c,""+e,!0),a.setRequestHeader("Content-Type","application/json; charset=utf-8"),r&&a.setRequestHeader("X-MCS-AppKey",""+r),a.onload=function(){if(i){var e=null;if(a.responseText){try{e=JSON.parse(a.responseText)}catch(t){e={}}i(e)}}},o&&(a.ontimeout=function(){n()}),a.onerror=function(){a.abort(),n&&n(t,v.XHR_ON)},a.send(JSON.stringify(t))}var S=function(e,t,i,n){try{var r,o=e.match(/\/v\d\//);r=o?o[0]:-1!==e.indexOf("/v1/")?"/v1/":"/v2/";var s=e.split(r)[0];if(!s)return void n(e,t,v.NO_URL);t.forEach(function(r){var o=function(e){var t="";for(var i in e)e.hasOwnProperty(i)&&void 0!==e[i]&&(t+="&"+i+"="+encodeURIComponent(JSON.stringify(e[i])));return"&"===t[0]?t.slice(1):t}(r),a=new Image(1,1);a.onload=function(){a=null,i&&i()},a.onerror=function(){a=null,n&&n(e,t,v.IMG_ON)},a.src=s+"/v1/gif?"+o})}catch(i){n&&n(e,t,v.IMG_CATCH,i.message)}},I=function(e,t,i,n,r,o,s,a){var u=window.navigator.userAgent,h=-1!==window.navigator.appName.indexOf("Microsoft Internet Explorer")&&(-1!==u.indexOf("MSIE 8.0")||-1!==u.indexOf("MSIE 9.0"));if(i&&h)S(e,t,n,r);else if(s)return c(!1).isSupportBeacon?(a&&a(),void(window.navigator.sendBeacon(e,JSON.stringify(t))?n():r(e,t,v.BEACON_FALSE))):void S(e,t,n,r);o&&delete t.app_key,k(e,t,n,r,i)};function E(e){return e?(e^16*Math.random()>>e/4).toString(10):([1e7]+-1e3+-4e3+-8e3+-1e11).replace(/[018]/g,E)}var O=function(){return E().replace(/-/g,"").slice(0,19)},T=function(){function e(e,t){this.browser=c(!0,e.app_id),this.config=e,this.cfg=t,this.storage=new l(!1),this.appInfo=e.app_key||e.app_id,this.isNoWebid=e.disable_webid,this.isNoSsid=e.disable_webid||e.disable_ssid,this.domain=e.channel_domain||p[e.channel],this.tokenReady=!1,this.checkExp=e.checkExp||!1,this.enableCookie=e.cross_subdomain||!1,this.expiresTime=this.enableCookie?94608e6:0,this.fetchUrl=""+this.domain+f}return e.prototype._getToken=function(){this.tokensKey=g(this.appInfo,!0),this.cookieKey="__tea_cookie_tokens_"+this.appInfo;var e=this.storage.getItem(this.tokensKey);if(this.enableCookie){var t=this.storage.getCookie(this.cookieKey);if(t){t=decodeURIComponent(t);var i=(t=JSON.parse(t)).user_unique_id,n=t.web_id,r=t.timestamp,o=t.ssid;this._setToken(n,i,o,r)}else{if(!e)return void this._requestWebId();this.storage.setCookie(this.cookieKey,encodeURIComponent(JSON.stringify(e)),this.expiresTime),this._checkLocal(e)}}else{if(!e)return void this._requestWebId();this._checkLocal(e)}},e.prototype._checkLocal=function(e){if(!e.web_id){var t=this.storage.getCookie("tt_webid"),i=this.storage.getCookie("__tea_sdk__ssid"),n=this.storage.getCookie("__tea_sdk__user_unique_id");if(t&&i&&n){var r={web_id:t,ssid:i,user_unique_id:n,timestamp:Date.now()};this.storage.setItem(this.tokensKey,r)}}var o=this.storage.getItem(this.tokensKey),s=(n=o.user_unique_id,t=o.web_id,o.timestamp);i=o.ssid,t&&n?this._setToken(t,n,i,s):this._requestWebId()},e.prototype._setToken=function(e,t,i,n){if(this.uuid=t,this.web_id=e,this.ssid=i,this.checkExp){var r=Date.now()-parseFloat(n);if(r>7344e6)return void this._requestWebId();if(r>432e7)return void this._updateWebId(e)}this._complete(e,t,i)},e.prototype._complete=function(e,t,i){this.cfg.envInfo.user.ssid=i,this.cfg.envInfo.user.web_id=e,this.cfg.envInfo.user.user_unique_id=t,this.tokenReady=!0},e.prototype._requestWebId=function(){this.isNoWebid?this._setwebId({web_id:O(),ssid:""}):this._fetchWebId(this.fetchUrl,!1)},e.prototype._updateWebId=function(e){var t=""+this.domain+f+"/"+e+"/update";this._fetchWebId(t,!0)},e.prototype._fetchWebId=function(e,t){var i=this;this.isGetWebId=!0,I(e,{app_key:this.config.app_key,app_id:this.config.app_id,url:location.href,user_agent:this.browser.userAgent,referer:this.browser.referrer,user_unique_id:""},this.config.app_key,function(e){if(e&&0===e.e)if(t){var n={web_id:i.web_id,ssid:i.ssid,user_unique_id:i.uuid,timestamp:Date.now()};i.enableCookie&&i.storage.setCookie(i.cookieKey,encodeURIComponent(JSON.stringify(n)),i.expiresTime),i.storage.setItem(i.tokensKey,n),i._complete(i.web_id,i.uuid,i.ssid),i.isGetSsid?i._requestSsId():i.callback&&i.callback()}else i.isGetWebId=!1,i._setwebId(e),i.isGetSsid?i._requestSsId():i.callback&&i.callback();else t?i._fetchWebId(i.fetchUrl,!1):i.isGetWebId=!1},function(){i.isGetWebId=!1},!0)},e.prototype._setwebId=function(e){var t=this.cfg.envInfo.user.web_id||e.web_id,i={web_id:t,ssid:e.ssid,user_unique_id:this._uuid?this._uuid:t,timestamp:Date.now()};this.enableCookie&&this.storage.setCookie(this.cookieKey,encodeURIComponent(JSON.stringify(i)),this.expiresTime),this.storage.setItem(this.tokensKey,i),this.cfg.envInfo.user.ssid=e.ssid,this.cfg.envInfo.user.web_id=t,this.cfg.envInfo.user.user_unique_id=this._uuid?this._uuid:t,this.uuid=this._uuid?this._uuid:t,this.web_id=t,this.ssid=e.ssid,this.tokenReady=!0},e.prototype._getSsid=function(e){e&&-1===["0","Null","None","","undefined"].indexOf(e)&&(this.uuid===e&&this.web_id&&this.ssid?this.tokenReady=!0:(this._uuid=e,this.uuid=e,this.cfg.envInfo.user.user_unique_id=e,this.isGetSsid=!0,this.isNoSsid||this.isGetWebId?this.callback&&this.callback():(this.tokenReady=!1,this.isGetSsid=!1,this._requestSsId())))},e.prototype._requestSsId=function(){var e=this,t=this.domain+"/v1/user/ssid";I(t,{app_key:this.config.app_key,app_id:this.config.app_id,web_id:this.web_id,user_unique_id:this.uuid},this.config.app_key,function(t){if(t&&0===t.e){e.cfg.envInfo.user.ssid=t.ssid;var i={web_id:e.web_id,ssid:t.ssid,user_unique_id:e.uuid,timestamp:Date.now()};e.enableCookie&&e.storage.setCookie(e.cookieKey,encodeURIComponent(JSON.stringify(i)),e.expiresTime),e.storage.setItem(e.tokensKey,i),e.tokenReady=!0}else e.tokenReady=!0;e.callback&&e.callback()},function(){e.tokenReady=!0,e.callback&&e.callback()},!0)},e.prototype.isTokenReady=function(){return this.tokenReady},e}(),x=function(e,t,i){void 0===e&&(e=[]),void 0===t&&(t=function(e){return e}),void 0===i&&(i=5);var n,r=[],o=0;return e.forEach(function(e){var s=t(e);void 0===n?n=s:(s!==n||r[o].length>=i)&&(o+=1,n=s),r[o]=r[o]||[],r[o].push(e)}),r},C=function(){function e(e,t,i,n){this.cfg=t,this.config=e,this._token=i,this.appInfo=e.app_key||e.app_id,this.debugMode=!!e.log,this.evtDataKey=g(this.appInfo,!1);var r=e.channel_domain||p[e.channel];this.reportUrl=e.report_url?e.report_url:""+r+_,this.storage=new l(!0),this.EventStorage=new l(!1),this.maxStorage=e.max_storage_num||-1;var o=e.enable_storage,s=e.disable_storage;this.closeStorage=!0,(o||!1===s)&&(this.closeStorage=!1),this.plugin=n,this.addListener()}return e.prototype.addListener=function(){var e=this;window.addEventListener("unload",function(){e.report(!0)},!1),window.addEventListener("beforeunload",function(){e.report(!0)},!1),document.addEventListener("visibilitychange",function(){"hidden"===document.visibilityState&&e.report(!0)},!1)},e.prototype.setReady=function(){this.isReady=!0,this.closeStorage||this.checkStorageEvent(),this.report()},e.prototype.event=function(e,t){var i=this;void 0===e&&(e=[]),void 0===t&&(t=!1);var n=this.storage.getItem(this.evtDataKey)||[],r=t?s(e,n):s(n,e);this.storage.setItem(this.evtDataKey,r),this.reportTimer&&clearTimeout(this.reportTimer),r.length>=5?this.report():this.reportTimer=setTimeout(function(){i.report(),i.reportTimer=null},30)},e.prototype.report=function(e){if(void 0===e&&(e=!1),this._token.isTokenReady()&&this.isReady){var t=this.storage.getItem(this.evtDataKey)||[],i=this._mergeEvents(t);this.storage.removeItem(this.evtDataKey),this._dealData(i,e)}},e.prototype._mergeEvents=function(e){var t=this;if(!e.length)return e;var i=this.cfg.get();return i.header.headers=JSON.stringify(i.header.headers),x(e,function(e){return!t.closeStorage&&!!e.params.__disable_storage__}).map(function(e){return n({events:e.map(function(e){var i=n({},t.cfg.get("evtParams"),e.params);return delete i.__disable_storage__,n({},e,{params:JSON.stringify(i)})}),user:i.user,header:i.header,verbose:t.debugMode?1:void 0},t.closeStorage?{}:{__disable_storage__:e[0].params.__disable_storage__})})},e.prototype._dealData=function(e,t){var i=this;if(!e.length)return e;var n=[];n=x(e,function(e){return!!e.__disable_storage__}),this.closeStorage||this.plugin.maxStorage&&this.plugin.maxStorage(n,this.maxStorage,this.evtDataKey,this.storage);var r={};n.forEach(function(e){var n=O();if(!i.closeStorage&&!e[0].__disable_storage__){var o=JSON.parse(JSON.stringify(e));o&&o[0]&&(o[0].header.__storage_index__=Date.now()),r[n]=o,i.EventStorage.setItem(i.evtDataKey,r)}i._send(n,e,t)})},e.prototype._send=function(e,t,i){var n=this;this.isSending=!0;var r=function(){n.isSending=!1};if(!this.closeStorage)try{t&&t[0]&&t[0].header.__storage_index__&&delete(t=JSON.parse(JSON.stringify(t)))[0].header.__storage_index__}catch(e){}this.plugin&&this.plugin.et_test&&this.plugin.et_test.send(t),I(this.reportUrl,t,this.config.app_key,function(){r();var t=n.EventStorage.getItem(n.evtDataKey)||{};Object.keys(t).length?(delete t[e],n.EventStorage.setItem(n.evtDataKey,t)):n.EventStorage.removeItem(n.evtDataKey)},function(e,t){r(),n.cfg.get("reportErrorCallback")(e,t),n.plugin&&n.plugin.monitor&&n.plugin.monitor.sdkError(n.config.app_key,n.reportUrl,e,t)},!1,i,r),this.plugin&&this.plugin.monitor&&this.plugin.monitor.sdkOnload(this.config.app_key,this.reportUrl,t)},e.prototype.checkStorageEvent=function(){var e=this;try{var t=this.EventStorage.getItem(this.evtDataKey)||{},i=Object.keys(t);i.length>0&&setTimeout(function n(){for(var r=[],o=0;o<5;o++)i.length>0&&r.push(i.shift());r.length>0&&r.forEach(function(i){e._send(i,t[i],!1)}),setTimeout(n,5)},5)}catch(e){}},e}(),N=void 0,A=(new Date).getTimezoneOffset(),D=parseInt(""+-A/60,10),P=60*A,V="4.1.8",q=function(){function e(e){var t=c(!0,e);this.envInfo={user:{user_unique_id:N,user_type:N,user_id:N,user_is_auth:N,user_is_login:N,device_id:N,web_id:N,ip_addr_id:N,ssid:N},header:{app_id:N,app_name:N,app_install_id:N,app_package:N,app_channel:N,app_version:N,os_name:t.os_name,os_version:t.os_version,device_model:t.device_model,ab_client:N,ab_version:N,ab_sdk_version:N,traffic_type:N,utm_source:t.utm_source,utm_medium:t.utm_medium,utm_campaign:t.utm_campaign,client_ip:N,device_brand:N,os_api:N,access:N,language:t.language,region:N,app_language:N,app_region:N,creative_id:N,ad_id:N,campaign_id:N,log_type:N,rnd:N,platform:t.platform,sdk_version:V,province:N,city:N,timezone:D,tz_offset:P,tz_name:N,sim_region:N,carrier:N,resolution:t.screen_width+"x"+t.screen_height,browser:t.browser,browser_version:t.browser_version,referrer:t.referrer,referrer_host:t.referrer_host,utm_term:t.utm_term,utm_content:t.utm_content,headers:{custom:{screen_width:t.screen_width,screen_height:t.screen_height}}}},this.evtParams={},this.reportErrorCallback=function(){}}return e.prototype.set=function(e,t){var i=this;if("evtParams"===e||"_staging_flag"===e){var r;r="evtParams"===e?t:{_staging_flag:Number(t)};var o=n({},r);Object.keys(o).forEach(function(e){i.evtParams[e]=o[e]})}else if("reportErrorCallback"===e&&"function"==typeof t)this.reportErrorCallback=t;else{var s="";if(e.indexOf(".")>-1){var a=e.split(".");s=a[0],e=a[1]}if("user_unique_id"===e){if(!t)return;if(-1!==["0","Null","None","","undefined"].indexOf(t))return}if("os_version"===e&&(e=""+t),"web_id"===e){if(!t)return;(!this.envInfo.user.user_unique_id||this.envInfo.user.user_unique_id&&this.envInfo.user.user_unique_id===this.envInfo.user.web_id)&&(this.envInfo.user.user_unique_id=t)}s?"user"===s||"header"===s?this.envInfo[s][e]=t:"headers"===s?this.envInfo.header.headers[e]=t:this.envInfo.header.headers.custom[e]=t:this.envInfo.user.hasOwnProperty(e)?["user_type","device_id","ip_addr_id"].indexOf(e)>-1?this.envInfo.user[e]=Number(t):["user_id","web_id","user_unique_id","ssid"].indexOf(e)>-1?this.envInfo.user[e]=String(t):["user_is_auth","user_is_login"].indexOf(e)>-1&&(this.envInfo.user[e]=Boolean(t)):this.envInfo.header.hasOwnProperty(e)?this.envInfo.header[e]=t:this.envInfo.header.headers.hasOwnProperty(e)?this.envInfo.header.headers[e]=t:this.envInfo.header.headers.custom[e]=t}},e.prototype.get=function(e){return e?"evtParams"===e?this.evtParams:"reportErrorCallback"===e?this.reportErrorCallback:JSON.parse(JSON.stringify(this.envInfo[e])):JSON.parse(JSON.stringify(this.envInfo))},e}();function L(){return{title:document.title||location.pathname,url:location.href,url_path:location.pathname}}function M(){return Date.now()}function R(){var e=m();return window[e]?window[e].l:M()}function j(){var e=!1;return["hidden","msHidden","webkitHidden"].forEach(function(t){void 0!==document[t]&&(e=!0)}),e}var J,U,W=function(){function e(e){var t=this;this._sendEvent=function(e){void 0===e&&(e=!1);var i=e?t.options.aliveDTime:M()-t.sessionStartTime;M()-t.pageStartTime>t.options.maxDuration||(t.event("predefine_page_alive",n({},L(),{duration:i,is_support_visibility_change:t.options.sup_vis_change?1:0})),t.sessionStartTime=M())},this._setUpTimer=function(){return t.timerHandler&&clearInterval(t.timerHandler),setInterval(function(){M()-t.sessionStartTime>t.options.aliveDTime&&t._sendEvent(!0)},1e3)},this._visibilitychange=function(){"hidden"===document.visibilityState?t.timerHandler&&(clearInterval(t.timerHandler),t._sendEvent()):"visible"===document.visibilityState&&(t.sessionStartTime=M(),t.timerHandler=t._setUpTimer())},this._beforeunload=function(){document.hidden||t._sendEvent()},this.event=e,this.isSupVisChange=j(),this.options={maxDuration:432e5,aliveDTime:6e4,sup_vis_change:j()},this.pageStartTime=R(),this.sessionStartTime=this.pageStartTime,this.timerHandler=null,this.disableCallback=function(){}}return e.prototype.enable=function(){this.disableCallback=this._enablePageAlive()},e.prototype.disable=function(){this.disableCallback(),this.pageStartTime=Date.now()},e.prototype._enablePageAlive=function(){var e=this;return this.timerHandler=this._setUpTimer(),window.addEventListener("visibilitychange",this._visibilitychange),window.addEventListener("beforeunload",this._beforeunload),function(){e._beforeunload(),window.removeEventListener("visibilitychange",e._visibilitychange),window.removeEventListener("beforeunload",e._beforeunload)}},e}(),H=function(){function e(e){var t=this;this._visibilitychange=function(){"hidden"===document.visibilityState?t.activeEndTime=M():"visible"===document.visibilityState&&(t.activeEndTime&&(t.totalTime+=t.activeEndTime-t.activeStartTime,t.activeTimes+=1),t.activeEndTime=void 0,t.activeStartTime=M())},this._beforeunload=function(){t.totalTime+=(t.activeEndTime||M())-t.activeStartTime,t._sendEventPageClose()},this.event=e,this.isSupVisChange=j(),this.options={sup_vis_change:this.isSupVisChange},this.disableCallback=function(){},this.pageStartTime=R(),this._resetData()}return e.prototype.enable=function(){this.disableCallback=this._enablePageClose()},e.prototype.disable=function(){this.disableCallback()},e.prototype._resetData=function(){this.activeStartTime=void 0===this.activeStartTime?R():Date.now(),this.activeEndTime=void 0,this.activeTimes=1,this.totalTime=0},e.prototype._sendEventPageClose=function(){var e=M()-this.pageStartTime;this.event("predefine_page_close",n({},L(),{active_times:this.activeTimes,duration:this.totalTime,total_duration:e,is_support_visibility_change:this.options.sup_vis_change?1:0})),this.pageStartTime=Date.now(),this._resetData()},e.prototype._enablePageClose=function(){var e=this;return window.addEventListener("visibilitychange",this._visibilitychange),window.addEventListener("beforeunload",this._beforeunload),function(){e._beforeunload(),window.removeEventListener("visibilitychange",e._visibilitychange),window.removeEventListener("beforeunload",e._beforeunload)}},e}(),K=function(){function e(e){this.pageAlive=new W(e),this.pageClose=new H(e),this._enable()}return e.prototype._enable=function(){this.pageAlive.enable(),this.pageClose.enable()},e.prototype._disable=function(){this.pageAlive.disable(),this.pageClose.disable()},e.prototype.reset=function(){this._disable(),this._enable()},e}(),B=function(){function e(e){var t=this;this._setInterval=function(){t._clearIntervalFunc=function(e,t){void 0===e&&(e=function(){}),void 0===t&&(t=1e3);var i,n=Date.now()+t;return i=window.setTimeout(function r(){var o=Date.now()-n;e(),n+=t,i=window.setTimeout(r,Math.max(0,t-o))},t),function(){window.clearTimeout(i)}}(function(){t._isSessionhasEvent&&t._endCurrentSession()},t.sessionInterval)},this._clearInterval=function(){t._clearIntervalFunc&&t._clearIntervalFunc()},this.sessionInterval=6e4,this._eventSenderFunc=e,this._startTime=0,this._lastTime=0,this._setInterval()}return e.prototype._endCurrentSession=function(){this._eventSenderFunc("_be_active",{start_time:this._startTime,end_time:this._lastTime,url:window.location.href,referrer:window.document.referrer}),this._isSessionhasEvent=!1,this._startTime=0},e.prototype.process=function(){this._isSessionhasEvent||(this._isSessionhasEvent=!0,this._startTime=+new Date);var e=this._lastTime||+new Date;this._lastTime=+new Date,this._lastTime-e>this.sessionInterval&&(this._clearInterval(),this._endCurrentSession(),this._setInterval())},e}();(U=J||(J={})).Normal="synchronize",U.Once="setOnce";var G,F,Q=function(){function e(e){var t,i=e.instance,n=e.appId,r=e.channel,o=e.app_key;this.instance=i,this.appId=n,this.app_key=o,this.channel=r,this.domain=this.getDomain(),this.urls=((t={})[J.Normal]=this.getUrl(J.Normal),t[J.Once]=this.getUrl(J.Once),t),this.autoId=0,this.lastId=0,this.lastOnceId=0,this.duration=1e4,this.data=null}return e.prototype.getDomain=function(){return y[this.channel].replace(/\/+$/,"")},e.prototype.getUrl=function(e){return this.domain+"/service/api/v3/userprofile/"+this.appId+"/"+e},e.prototype.getData=function(e){void 0===e&&(e={});var t=this.instance._config.get(),i=t.user,o=t.header,s=o.headers,a=r(o,["headers"]),c=s.custom,u=r(s,["custom"]);return{user:{web_id:i.web_id,ssid:i.ssid,user_unique_id:i.user_unique_id},header:n({},a||{},u||{}),profile:n({},c||{},e||{})}},e.prototype.start=function(){var e=this;this.autoId>0||(this.upPre(J.Normal),this.autoId=window.setInterval(function(){e.upPre(J.Normal)},this.duration))},e.prototype.stop=function(){this.autoId>0&&window.clearInterval(this.autoId)},e.prototype.setProfile=function(e){var t=Date.now();(!this.lastId||t-this.lastId>=this.duration)&&(this.instance.config(e),this.upPre(J.Normal,e),this.lastId=t)},e.prototype.setOnceProfile=function(e){var t=Date.now();(!this.lastOnceId||t-this.lastOnceId>=this.duration)&&(this.instance.config(e),this.upPre(J.Once,e),this.lastOnceId=t)},e.prototype.upPre=function(e,t){void 0===t&&(t={});var i=this.getData(t);this.data&&JSON.stringify(this.data)===JSON.stringify(i)||(this.up(this.urls[e],i),this.data=i)},e.prototype.up=function(e,t){I(e,t)},e}(),X=function(){function e(){}return e.prototype.sdkOnload=function(e,t,i){if(!this.sdkReady){this.sdkReady=!0;try{if(0===i.lenth)return;var n=i[0],r=n.header,o=n.user,s=r.app_id,a=r.app_name,c=r.sdk_version,u=o.web_id,h={events:[{event:"onload",params:JSON.stringify({app_key:e,app_id:s,app_name:a||"",sdk_version:c}),local_time_ms:Date.now()}],user:{user_unique_id:u},header:{}};setTimeout(function(){I(t,[h],"566f58151b0ed37e")},16)}catch(e){}}},e.prototype.sdkError=function(e,t,i,n){try{var r=i[0],o=r.user,s=r.header,a=[];i.forEach(function(e){e.events.forEach(function(e){a.push(e)})});var c={events:a.map(function(t){return{event:"on_error",params:JSON.stringify({error_code:n,app_key:e,app_id:s.app_id,app_name:s.app_name||"",error_event:t.event,local_time_ms:t.local_time_ms,tea_event_index:Date.now(),params:t.params,header:JSON.stringify(s),user:JSON.stringify(o)}),local_time_ms:Date.now()}}),user:{user_unique_id:o.user_unique_id},header:{}};setTimeout(function(){I(t,[c],"566f58151b0ed37e")},16)}catch(e){}},e}(),$=new l(!1),z=function(e){return"__tea_sdk_ab_version_"+e},Y=function(e){var t={ab_version:[],data:null,timestamp:+new Date};try{t=$.getItem(z(e))||t}catch(e){}return t},Z=function(e,t){try{var i=Y(e);$.setItem(z(e),n({},i,t))}catch(U){}};!function(e){e[e.No=0]="No",e[e.Ing=1]="Ing",e[e.Complete=2]="Complete"}(G||(G={})),function(e){e[e.Var=0]="Var",e[e.All=1]="All"}(F||(F={}));var ee=function(){function e(e){this.appId=0,this.user={},this.domain="",this.protocal=location.protocol,this.fetchStatus=G.No,this.callbacks=[],this.data=null,this.versions=[],this.collector=e;var t=this.collector._initConfig,i=t.app_id,n=t.channel,r=t.enable_multilink,o=t.multilink_timeout_ms,s=t.ab_channel_domain;this.appId=i,this.domain=s||w[n||"cn"],this.multilink=r||!1,this.isWait=!1,this.closeTime=o||2e3,this._check(),this.wait()}return e.prototype.init=function(e){var t=e.user,i=e.header,o=i.headers,s=r(i,["headers"]),a=o||{};this.user=n({},t),this._fetch(n({},s,a))},e.prototype.wait=function(){var e=this;this.multilink&&(this.isWait||(this.openOverlayer(),this.isWait=!0),setTimeout(function(){e.closeOverlayer()},this.closeTime))},e.prototype.getAllVars=function(e){if("function"!=typeof e)throw new Error("\u56de\u8c03\u51fd\u6570\u5fc5\u987b\u4e3a\u4e00\u4e2a\u51fd\u6570");var t={callback:e,type:F.All};this.fetchStatus===G.Complete?this._getAllVars(t):this.callbacks.push(t)},e.prototype.getVar=function(e,t,i){if(!e)throw new Error("\u53d8\u91cf\u540d\u4e0d\u80fd\u4e3a\u7a7a");if(void 0===t)throw new Error("\u53d8\u91cf\u6ca1\u6709\u9ed8\u8ba4\u503c");if("function"!=typeof i)throw new Error("\u56de\u8c03\u51fd\u6570\u5fc5\u987b\u4e3a\u4e00\u4e2a\u51fd\u6570");var n={name:e,defaultValue:t,callback:i,type:F.Var};this.fetchStatus===G.Complete?(this._getVar(n),this._updateVersions()):this.callbacks.push(n)},e.prototype.openOverlayer=function(){!function(){if(!document.getElementById(b)){var e="body { opacity: 0 !important; }",t=document.head||document.getElementsByTagName("head")[0],i=document.createElement("style");i.id=b,i.type="text/css",i.styleSheet?i.styleSheet.cssText=e:i.appendChild(document.createTextNode(e)),t.appendChild(i)}}()},e.prototype.closeOverlayer=function(){var e;(e=document.getElementById(b))&&e.parentElement.removeChild(e)},e.prototype._check=function(){var e=this,t=function(e){var t=Y(e),i=t.timestamp;if(Date.now()-i>=2592e6){try{$.removeItem("__tea_sdk_ab_version")}catch(e){}return null}return t}(this.appId);if(t){var i=t.ab_version,n=t.data;i&&i.length&&(this.versions=i,this.data=n,setTimeout(function(){e._configVersions()}))}},e.prototype._fetchComplete=function(e){var t=this;if(e){!function(e,t){Z(e,{data:t})}(this.appId,e),this.data=e;var i=[];Object.keys(e).forEach(function(t){var n=e[t].vid;n&&i.push(n)}),this.versions=this.versions.filter(function(e){return i.includes(e)});var n=e.$ab_url;if(n){var r=n.val,o=n.vid;r&&o&&this.getVar("$ab_url",window.location.href,function(){r!==window.location.href&&setTimeout(function(){var e=""+r;e=-1===e.indexOf("http")?"https://"+e:e,window.location.href=e},50)})}}this.callbacks.forEach(function(e){return t[e.type===F.Var?"_getVar":"_getAllVars"](e)}),this.callbacks=[],this._updateVersions(),this.closeOverlayer()},e.prototype._getAllVars=function(e){(0,e.callback)(this.data?JSON.parse(JSON.stringify(this.data)):{})},e.prototype._getVar=function(e){var t=e.name,i=e.defaultValue,n=e.callback,r=this.data;if(r)if("object"==typeof r[t]&&void 0!==r[t].val){n(r[t].val);var o=r[t].vid;this.versions.includes(o)||this.versions.push(o)}else n(i);else n(i)},e.prototype._updateVersions=function(){var e,t;e=this.appId,t=this.versions,Z(e,{ab_version:t,timestamp:Date.now()}),this._configVersions()},e.prototype._configVersions=function(){var e=this.versions.join(",");e&&this.collector.config({ab_sdk_version:e})},e.prototype._url=function(){return this.domain+"/service/2/abtest_config/"},e.prototype._fetch=function(e,t){var i=this,r=void 0===t?{}:t,o=r.success,s=void 0===o?function(){}:o,a=r.fail,c=void 0===a?function(){}:a;this.fetchStatus=G.Ing,k(this._url(),{header:n({aid:this.appId},this.user||{},e||{},{ab_sdk_version:this.versions.join(","),ab_url:window.location.href})},function(e){i.fetchStatus=G.Complete;var t=e.data;"success"===e.message?(i._fetchComplete(t),s(t)):(i._fetchComplete(null),c())},function(){i.fetchStatus=G.Complete,c(),i._fetchComplete(null)},"",3e3)},e}(),te=function(e,t,i,n){if(t){var r=e.filter(function(e){return!e[0].__disable_storage__}).length;if(r>0)try{var o=n.getItem(i);if(o){var s=Object.keys(o),a=s.length+r-t;if(a>0){for(var c=s.map(function(e){var t=o[e];return{id:e,index:t&&t[0]?t[0].header.__storage_index__:+new Date}}).sort(function(e,t){return e.index-t.index}),u=0;u<a;u++){var h=c.shift();h&&h.id&&o[h.id]&&delete o[h.id]}n.setItem(i,o)}}}catch(e){}}},ie=function(e,t,i){t&&(t.enable_stay_duration&&(this.stay=new K(i)),t.auto_profile&&t.channel&&(this.profile=new Q({instance:e,app_key:t.app_key,appId:t.app_id,channel:t.channel})),t.disable_session||(this.session=new B(i)),t.disable_sdk_monitor||(this.monitor=new X),t.enable_ab_test&&(this.ab=new ee(e)),t.max_storage_num&&(this.maxStorage=te))},ne=function(){function e(e,t){this.isLog=t,this.name=e||""}var t=e.prototype;return t.info=function(e){this.isLog&&console.log(this.name+" "+e)},t.warn=function(e){this.isLog&&console.warn(this.name+" "+e)},t.error=function(e){this.isLog&&console.error(this.name+" "+e)},t.throw=function(e){throw this.error(this.name),new Error(e)},e}();function re(e,t){if(void 0===t&&(t="list"),!e)return!1;if(t&&"list"===t){if(["LI","TR","DL"].includes(e.nodeName))return!0;if(e.dataset&&e.dataset.hasOwnProperty("teaIdx"))return!0;if(e.hasAttribute&&e.hasAttribute("data-tea-idx"))return!0}else{if(["A","BUTTON"].includes(e.nodeName))return!0;if(e.dataset&&e.dataset.hasOwnProperty("teaContainer"))return!0;if(e.hasAttribute&&e.hasAttribute("data-tea-container"))return!0}return!1}function oe(e){for(var t=e;t&&!re(t,"container");){if("HTML"===t.nodeName||"BODY"===t.nodeName)return e;t=t.parentElement}return t||e}var se,ae=function(e){if(e.children.length){var t=e.children;return![].slice.call(t).some(function(e){return e.children.length>0})}return!0},ce=function(e){for(var t=e.parentElement,i=!1;t;)"svg"===t.tagName.toLowerCase()?(t=null,i=!0):t=t.parentElement;return i};function ue(e,t,i){void 0===t&&(t=""),void 0===i&&(i={});var n=e;"/"===(n=n.split("#")[0].split("?")[0])[e.length-1]&&(n=n.substr(0,e.length-1)),n="/"===t[0]?n.replace(/(https?:\/\/[\w-]+(\.[\w-]+){1,}(:[0-9]{1,5})?)(\/[.\w-]+)*\/?$/,"$1"+t):n.replace(/(https?:\/\/[\w-]+(\.[\w-]+){1,}(:[0-9]{1,5})?(\/[.\w-]+)*?)(\/[.\w-]+)?\/?$/,"$1/"+t);var r=Object.keys(i).map(function(e){return e+"="+i[e]}).join("&");return r.length>0?n+"?"+r:n}function he(e,t){return{is_html:1,is_back:0,page_key:location.href,refer_page_key:document.referrer}}"undefined"!=typeof window&&(se=window.location.href);var de=function(){function e(e,t){var i=this;this.clickEvent=function(e){(function(e){var t=window.innerHeight,i=window.innerWidth;if(1!==e.nodeType)return!1;if(ce(e))return!1;if(["HTML","BODY"].includes(e.tagName.toUpperCase()))return!1;var n=e;return!("none"===n.style.display||!re(n,"container")&&(!ae(n)||n.clientHeight*n.clientWidth>.5*t*i))})(e.target)&&i.eventHandel({eventType:"dom",eventName:"click"},e)},this.changeEvent=function(e){i.eventHandel({eventType:"dom",eventName:"change"},e)},this.submitEvent=function(e){i.eventHandel({eventType:"dom",eventName:"submit"},e)},this.getPageViewEvent=function(e,t,n){i.eventHandel({eventType:"dom",eventName:"page_view"},n)},this.config=t.getConfig().eventConfig,this.options=e}return e.prototype.init=function(e){this.eventHandel=e;var t=this.config.mode;this.addListener(t)},e.prototype.addListener=function(e){"proxy-capturing"===e&&(this.config.click&&window.document.addEventListener("click",this.clickEvent,!0),this.config.change&&window.document.addEventListener("change",this.changeEvent,!0),this.config.submit&&window.document.addEventListener("submit",this.submitEvent,!0),this.config.pv&&function(e,t){void 0===t&&(t=!1),function(e){var t,i;t=window.history,i=t.pushState,t.pushState=function(n){"function"==typeof t.onpushstate&&t.onpushstate({state:n});for(var r=arguments.length,o=new Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];var a=i.call.apply(i,[t,n].concat(o)),c=he();return se=ue(location.href,o[1]),e("popstate",n,c),a},function(t){var i=t.replaceState;t.replaceState=function(n){"function"==typeof t.onreplacestate&&t.onreplacestate({state:n});for(var r=arguments.length,o=new Array(r>1?r-1:0),s=1;s<r;s++)o[s-1]=arguments[s];var a=i.call.apply(i,[t,n].concat(o)),c=he();return se=ue(location.href,o[1]),e("replaceState",n,c),a}}(window.history)}(e);var i=null;window.addEventListener("hashchange",function(n){if(se!==window.location.href&&(clearTimeout(i),t)){se=window.location.href;var r={is_html:1,page_key:location.href,refer_page_key:document.referrer};e("hashchange",n,r)}}),window.addEventListener("popstate",function(t){se!==window.location.href&&(i=setTimeout(function(){se=window.location.href;var i=he();e("popstate",t,i)},10))});var n=he();e("popstate",null,n)}(this.getPageViewEvent,this.options.hashTag||this.config.hashTag))},e.prototype.removeListener=function(){window.document.removeEventListener("click",this.clickEvent,!0),window.document.removeEventListener("change",this.changeEvent,!0),window.document.removeEventListener("submit",this.submitEvent,!0)},e}(),le={eventConfig:{mode:"proxy-capturing",submit:!1,click:!0,change:!1,pv:!0,hashTag:!1,impr:!1},scoutConfig:{mode:"xpath"}},pe=function(){function e(e){this.config=e}return e.prototype.getConfig=function(){return this.config},e.prototype.setConfig=function(e){return this.config=e},e}();function fe(e,t){var i={element_path:"",positions:[],texts:[]},n=function(e){if(e){var t=e.getBoundingClientRect(),i=t.width,n=t.height;return{left:t.left,top:t.top,element_width:i,element_height:n}}}(t),r=function(e,t){void 0===e&&(e={}),void 0===t&&(t={});var i=e.clientX,n=e.clientY,r=t.left,o=t.top;return{touch_x:Math.floor(i-r),touch_y:Math.floor(n-o)}}(e,n),o=n.element_width,s=n.element_height,a=r.touch_x,c=r.touch_y,u=function(e){for(var t=[];null!==e.parentElement;)t.push(e),e=e.parentElement;var i=[],n=[];return t.forEach(function(e){var t=function(e){if(null===e)return{str:"",index:0};var t=0,i=e.parentElement;if(i)for(var n=i.children,r=0;r<n.length&&n[r]!==e;r++)n[r].nodeName===e.nodeName&&t++;return{str:[e.nodeName.toLowerCase(),re(e,"list")?"[]":""].join(""),index:t}}(e),r=t.str,o=t.index;i.unshift(r),n.unshift(o)}),{element_path:"/"+i.join("/"),positions:n}}(t),h=u.element_path,d=u.positions,l=function(e){var t=oe(e),i=[];return function e(t){var n=function(e){var t="";return 3===e.nodeType?t=e.textContent.trim():e.dataset&&e.dataset.hasOwnProperty("teaTitle")?t=e.getAttribute("data-tea-title"):e.hasAttribute("ata-tea-title")?t=e.getAttribute("data-tea-title"):e.hasAttribute("title")?t=e.getAttribute("title"):"INPUT"===e.nodeName&&["button","submit"].includes(e.getAttribute("type"))?t=e.getAttribute("value"):"IMG"===e.nodeName&&e.getAttribute("alt")&&(t=e.getAttribute("alt")),t.slice(0,200)}(t);if(n&&-1===i.indexOf(n)&&i.push(n),t.childNodes.length>0)for(var r=t.childNodes,o=0;o<r.length;o++)8!==r[o].nodeType&&e(r[o])}(t),i}(t);i.element_path=h,i.positions=d.map(function(e){return""+e}),i.texts=l,i.element_width=Math.floor(o),i.element_height=Math.floor(s),i.touch_x=a,i.touch_y=c;var p=oe(t);return"A"===p.tagName&&(i.href=p.getAttribute("href")),"IMG"===t.tagName&&(i.src=t.getAttribute("src")),i}function _e(e,t,i){return n({event:e},fe(t,i),{is_html:1,page_key:window.location.href})}var ve=function(){function e(){}return e.prototype.handleEvent=function(e,t){try{if(function(e){for(var t=e;t&&t.parentNode;){if(t.hasAttribute("data-tea-ignore"))return!0;if("HTML"===t.nodeName||"body"===t.nodeName)return!1;t=t.parentNode}return!1}(e.target))return null;var i="bav2b_click";switch(t){case"click":return _e(i="bav2b_click",e,e.target);case"change":return n({},_e(i="bav2b_change",e,e.target),function(e,t){try{if("bav2b_change"===e)return t.hasAttribute("data-tea-track")?{value:t.value}:{}}catch(e){return{}}}(i,e.target));case"submit":return _e(i="bav2b_submit",e,e.target)}}catch(U){return console.error(U),null}},e.prototype.handleViewEvent=function(e){return void 0===e&&(e={event:""}),e.event="bav2b_page",e},e}(),ge=function(){function e(e){this.logFunc=e}return e.prototype.send=function(e,t){var i=e.eventName;if("report_click_event"===i||"report_change_event"===i||"report_submit_event"===i||"report_page_view_event"===i||"report_exposure_event"===i){var n=t.event;delete t.event,this.logFunc(n,t)}},e.prototype.get=function(e,t){var i=Object.assign({headers:{"content-type":"application/json"},method:"GET"},t);fetch(e,i)},e.prototype.post=function(e,t){var i=Object.assign({headers:{"content-type":"application/json"},method:"POST"},t);fetch(e,i)},e}(),me={},ye=[],we=function(e){e.length&&e.forEach(function(e){ye.push(e)})};function be(e,t,i,n){var r=e&&e.source||window.opener||window.parent,o=e&&e.origin||n||"*",s={type:t,payload:i};r.postMessage(JSON.stringify(s),o)}function ke(e){if(ye.some(function(e){return"*"===e})||ye.some(function(t){return e.origin.indexOf(t)>-1})){var t=e.data;if("string"==typeof e.data)try{t=JSON.parse(e.data)}catch(e){t=void 0}if(!t)return;var i=t.type,n=t.payload;me[i]&&me[i].forEach(function(t){"function"==typeof t&&t(e,n)})}}var Se="_TEA_VE_OPEN",Ie="_TEA_VE_APIHOST";window.TEAVisualEditor=window.TEAVisualEditor||{};var Ee="",Oe=window.TEAVisualEditor.__editor_url||"https://s3.pstatp.com/pgc/tech/collect/visual-editor.js",Te="https://s3.pstatp.com/pgc/tech/collect/visual-editor-rangers.js",xe=!1;function Ce(e){var t,i,n,r,o=e.event,s=e.editorUrl,a=e.autoTrackInstance;e.fromSession,xe||(xe=!0,t=s,i=function(){be(o,"editorScriptloadSuccess"),a.destroy()},n=function(){o&&be(o,"editorScriptloadError"),xe=!1},(r=document.createElement("script")).src=t,r.onerror=function(){n()},r.onload=function(){i()},document.getElementsByTagName("head")[0].appendChild(r))}var Ne,Ae={hashTag:!1,impr:!1},De=new(function(){function e(){this.autoTrackStart=!1}return e.prototype.start=function(e,t){t=Object.assign(Ae,t),this.destroyed=!1,this.options=t,this.logFunc=e,this.Config=new pe(le),this.Listener=new de(t,this.Config),this.EventHandle=new ve,this.Request=new ge(this.logFunc),this.autoTrackStart=!0,this.init()},e.prototype.init=function(){this.Listener.init(this.handle.bind(this))},e.prototype.handle=function(e,t){"dom"===e.eventType&&this.handleDom(e,t)},e.prototype.handleDom=function(e,t){var i=e.eventName;if("click"===i||"change"===i||"submit"===i){var n=this.EventHandle.handleEvent(t,i);null!==n&&this.Request.send({eventType:"custom",eventName:"report_"+i+"_event",extra:{methods:"GET"}},n)}else if("page_view"===i){var r=this.EventHandle.handleViewEvent(t);r&&this.Request.send({eventType:"custom",eventName:"report_page_view_event",extra:{methods:"GET"}},r)}},e.prototype.destroy=function(){if(!this.autoTrackStart)return console.warn("engine is undefined, make sure you have called autoTrack.start()");this.autoTrackStart=!1,this.Listener.removeListener()},e}()),Pe=["setProfile","setOnceProfile","getVar","openOverlayer","closeOverlayer","getAllVars","getToken"],Ve=s(["init","config","send","start","predefinePageView","resetStayDuration"],Pe),qe=(Ne=+Date.now()+Number((""+Math.random()).slice(2,8)),function(){return Ne+=1}),Le=function(){function e(e){var t=this;this.predefinePageView=function(e){void 0===e&&(e={});var i=n({title:document.title||location.pathname,url:location.href,url_path:location.pathname,time:Date.now(),referrer:window.document.referrer},t._event.closeStorage?{}:{__disable_storage__:1}),r=n({},i,e);t.event("predefine_pageview",r,!0)},this.getToken=function(e){var i;t._token.isTokenReady()&&(i=t._config.get().user,e(n({},i)))},this.name=e,this._isSend=!1,this.autoPV=!0}return e.prototype.init=function(e){var t=this;if(!this._inited){if(this._inited=!0,!e||"object"!=typeof e)throw new Error("init\u53c2\u6570\u6709\u8bef\uff0c\u8bf7\u68c0\u67e5");var i=e.app_id,n=e.app_key,r=e.log;this._config=new q(i),this.logger=new ne(this.name,r),n||i||this.logger.throw("\u6ca1\u6709\u4f20\u5165 app_key \u6216 app_id "),i&&"number"!=typeof i&&this.logger.throw("app_id\u53c2\u6570\u6709\u8bef\uff0c\u8bf7\u68c0\u67e5 "),n&&"string"!=typeof n&&this.logger.warn("app_key\u4e3a\u7a7a\uff0c\u5982\u679c\u6709\u8bf7\u4f20\u5165"),e.channel&&-1!==["cn","sg","va"].indexOf(e.channel)||this.logger.throw("channel \u53d8\u91cf\u53ea\u80fd\u662f `cn`, `sg`,`va`"),this._config.set("app_id",i),e.channel=e.channel?e.channel:"cn",this._initConfig=e,this._token=new T(e,this._config),this._token.callback=function(){t.callbackSend?t.start():t._event&&t._event.report()},this.plugin=new ie(this,e,this.event.bind(this)),this._event=new C(e,this._config,this._token,this.plugin),this._token._getToken(),e.autotrack&&function(e,t){var i=e.autotrack;if(i){var n={};"object"==typeof i&&(n=i),De.start(t,n),function(e,t){if(window.TEAVisualEditor.appId=t.app_id,we(["https://data.bytedance.com","https://datarangers.com.cn","https://www.byterangers.com","https://byterangers.bytedance.com"]),(window.opener||window.parent).postMessage("[tea-sdk]ready","*"),window.addEventListener("message",ke,!1),"1"===u.get(Se)){var i=u.get(Ie);i?(window.TEAVisualEditor.__editor_ajax_domain=i,Ce({event:null,editorUrl:Te,autoTrackInstance:e,fromSession:!1})):Ce({event:null,editorUrl:Oe,autoTrackInstance:e,fromSession:!1})}else!function(e,t){me[e]=me[e]||[],me[e].push(t)}("tea:openVisualEditor",function(t){var i=t.data;if("string"==typeof t.data)try{i=JSON.parse(t.data)}catch(e){i=void 0}if(i){var n=i.referrer;n?(window.TEAVisualEditor.__editor_ajax_domain=n,Ee=Te,window.TEAVisualEditor.__editor_url=Te):(Ee=Oe,window.TEAVisualEditor.__editor_url=Oe),Ce({event:t,editorUrl:Ee,autoTrackInstance:e})}}),window.TEAVisualEditor.openAutotrackEditor=function(){Ce({event:null,editorUrl:window.TEAVisualEditor.__editor_url,autoTrackInstance:e})}}(De,e)}else De.autoTrackStart&&De.destroy()}(e,this.event.bind(this))}},e.prototype.config=function(e){if(this._inited)if(e&&"object"==typeof e){if(e.user_unique_id){if("string"!=typeof e.user_unique_id)throw new Error("user_unique_id \u53ea\u80fd\u662fstring");this._token._getSsid(e.user_unique_id)}for(var t in e.disable_auto_pv&&(this.autoPV=!1),e)this._config.set(t,e[t])}else this.logger.warn("config\u53c2\u6570\u6709\u8bef\uff0c\u8bf7\u68c0\u67e5");else this.logger.warn("config\u5e94\u5728init\u4e4b\u540e\u8c03\u7528")},e.prototype.send=function(){this.start()},e.prototype.start=function(){if(this._token.isTokenReady()){if(this._isSend)return;this._isSend=!0,this.logger.info("\u7528\u6237\u4fe1\u606f\uff1a"+JSON.stringify(this._config.get("user"))),this._event.setReady(),this.autoPV&&this.predefinePageView(),this.plugin&&this.plugin.profile&&this.plugin.profile.start(),this.plugin&&this.plugin.ab&&this.plugin.ab.init(this._config.get())}else this.callbackSend=!0},e.prototype.event=function(){for(var e,t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];var n="boolean"==typeof t[t.length-1]&&t[t.length-1],r="boolean"==typeof t[t.length-1]?t.slice(0,t.length-1):t,a=o(r,1)[0],c=[];"Array"!==Object.prototype.toString.call(a).slice(8,-1)?c[0]=r:c=r;var u=this._initConfig.autotrack;c=c.map(function(e){return function(e,t,i){var n=(void 0===i?{}:i).isBav,r=void 0!==n&&n,o=e;/^event\./.test(e)&&(o=e.slice(6));var s=t;"object"!=typeof s&&(s={}),s.event_index=qe();var a={event:o,params:s,local_time_ms:+new Date,is_bav:0};return r&&(a.is_bav=1),a}(e[0],e[1],{isBav:!!u})}),this._event.event(c,n),this.plugin&&this.plugin.session&&(e=this.plugin.session).process.apply(e,s(t))},e.prototype.resetStayDuration=function(){!this.plugin||this.plugin.stay?this.plugin&&this.plugin.stay&&this.plugin.stay.reset():this.logger.info("\u505c\u7559\u65f6\u957f\u672a\u521d\u59cb\u5316")},e.prototype.setProfile=function(e){this.plugin&&this.plugin.profile&&this.plugin.profile.setProfile(e)},e.prototype.setOnceProfile=function(e){this.plugin&&this.plugin.profile&&this.plugin.profile.setOnceProfile(e)},e.prototype.getVar=function(e,t,i){this.plugin&&this.plugin.ab.getVar(e,t,i)},e.prototype.openOverlayer=function(){this.plugin&&this.plugin.ab&&this.plugin.ab.openOverlayer()},e.prototype.closeOverlayer=function(){this.plugin&&this.plugin.ab&&this.plugin.ab.closeOverlayer()},e.prototype.getAllVars=function(e){this.plugin&&this.plugin.ab&&this.plugin.ab.getAllVars(e)},e}();function Me(e,t,i){return t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i,e}var Re=function(e){var t=this;return Me(this,"_exportCollect",function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];t._isProcess?t._executeCmd.apply(t,i):(t.cmdQueue.push(i),t._processCmd())}),Me(this,"_processCmd",function(){if(0!==t.cmdQueue.length){var e,i,n=(e=t.cmdQueue,"init","0",i=-1,e.forEach(function(e,t){"init"===e[0]&&(i=t)}),i);if(-1!==n){t._isProcess=!0;var r=t.cmdQueue[n][1];if(r&&r.alias){var o=r.alias,s=function(e,t){if(null==e)return{};var i,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)i=o[n],t.indexOf(i)>=0||(r[i]=e[i]);return r}(r,["alias"]);t._alias=Object.keys(o).reduce(function(e,t){var i=o[t];return i&&Pe.includes(t)&&(e[i]=t),e},{}),t.cmdQueue[n][1]=Object.assign({},s||{})}t._executeCmd.apply(t,t.cmdQueue[n]),t.cmdQueue.forEach(function(e,i){i!==n&&t._executeCmd.apply(t,e)}),t.cmdQueue=[]}}}),Me(this,"_executeCmd",function(){for(var e=arguments.length,i=new Array(e),n=0;n<e;n++)i[n]=arguments[n];var r,o,s=i[0];t._alias[s]&&(s=t._alias[s]),Ve.indexOf(s)>-1?(r=t.colloctor)[s].apply(r,i.slice(1)):(o=t.colloctor).event.apply(o,i)}),this.cmdQueue=[],this.name=e,this.colloctor=new Le(e),this._isProcess=!1,this._alias={},this._processCmd(),Ve.forEach(function(e){t._exportCollect[e]=t._exportCollect.bind(t,e)}),this._exportCollect},je={},Je={},Ue=function(e){return Je[e]||(Je[e]=[]),Je[e]},We=function(e){var t=o(e),i=t[0],n=t.slice(1),r=i.split(".");if(1===r.length)Ue("default").push(s([i],n));else if(2===r.length)"event"===r[0]?Ue("default").push(s([i],n)):Ue(r[0]).push(s([r[1]],n));else{var a=r[0],c=[r[1],r[2]].join(".");Ue(a).push(s([c],n))}},He=function(){Ke.q.forEach(function(e){var t=[].slice.call(e);"Array"===Object.prototype.toString.call(t[0]).slice(8,-1)?t.forEach(function(e){We(e)}):We(t)}),Object.keys(Je).forEach(function(e){Je[e].forEach(function(t){(function(e){return je[e]||(je[e]=new Re(e)),je[e]})(e).apply(void 0,s(t))}),Je[e]=[]}),Ke.q=[]},Ke=function e(){for(var t=[],i=0;i<arguments.length;i++)t[i]=arguments[i];e.q.push(t),He()};Ke.q=[],Ke.l=Date.now(),Ke._instanceMap=je,Ke._instanceCmdMap=Je,Ve.forEach(function(e){Ke[e]=Ke.bind(null,e)}),function(e){if("undefined"!=typeof window){var t=m();if(t&&window[t]){var i=window[t];i.init||(e.q=i.q||[],e.l=i.l||Date.now(),window[t]=e)}}}(Ke),He();var Be=Re;t.default=Ke}}]);